[
  {
    "objectID": "1cc9a4820ad4da96/notebooks/00_notes.out.html",
    "href": "1cc9a4820ad4da96/notebooks/00_notes.out.html",
    "title": "Notes",
    "section": "",
    "text": "Code\nimport polars as pl\nfrom beforerr.project import datadir\n\n\n\n\nCode\ndf = pl.read_csv(datadir() / 'psp_events.csv', try_parse_dates=True)\ndf.to_pandas()\n\n\n\nAnisotropy\n\nPSP_SWP_SPI_SF00_L3_MOM\n\nNotes: Partial moments of the Proton distribution function in the SPAN-Ion instrument, PSP spacecraft, and RTN coordinate systems. User should be aware that the full ion distribution is typically NOT in the FOV of the instrument.\nT_TENSOR Partial Moment Temperature Tensor in instrument frame\n\nWI_H0_SWE\n\nTe_anisotropy Temperature anisotropy = Te_para / Te_perp\n\nWI_PLSP_3DP\n\nMOM.P.MAGT3 —&gt; [P.SYMM_MAGT3] Proton temperature tensor… rotated into a field-aligned coordinate basis and then taking the diagonal elements only\n\nWI_ELM2_3DP : Wind 3dp, PESA Low (~24 sec resolution) energy spectra with ion moments\n\nMAGT3 —&gt; [MAGT3] electron temperature tensor… rotated into a field-aligned coordinate basis and then taking the diagonal elements only\n\nTHB_L2_ESA\n\nthb_peeb_magt3Q —–Electron Temperature, Field Aligned (Tprp1FA, Tprp2FA, TparFA)\nthb_peef_magt3Q —–Electron Temperature, Field Aligned (Tprp1FA, Tprp2FA, TparFA)\nthb_peif_magt3Q —–Temperature, Field Aligned (TprpFA1, TprpFA2, TparFA)\n\nTHB_L2_MOM\n\nthb_peem_ptens_magQ —–Electron Pressure Tensor, Field Aligned\nthb_peem_t3_magQ —–Electron Temperature, Field Aligned (TprpFA1, TprpFA2, TparFA)\nthb_peim_ptens_magQ —–Ion Pressure Tensor, Field Aligned\nthb_peim_t3_magQ —–Ion Temperature, Field Aligned (TprpFA1, TprpFA2, TparFA)",
    "crumbs": [
      "Home",
      "1cc9a4820ad4da96",
      "Notebooks",
      "Notes"
    ]
  },
  {
    "objectID": "notebooks/10_results.html",
    "href": "notebooks/10_results.html",
    "title": "Results",
    "section": "",
    "text": "Code\nusing DrWatson\n@quickactivate\ninclude(srcdir(\"main.jl\"))\nimport Beforerr: easy_save\nusing AlgebraOfGraphics: linear\nusing Dates\nCode\nenc = \"enc8\" # event id (encounter id)    \neasy_save(fname) = Beforerr.easy_save(fname; dir=\"$fig_dir/$enc\", formats=[:svg])\nmkpath(\"$fig_dir/$enc\");\nCode\nbegin\n    psp_df = load(enc, \"PSP\"; dataset=\"Parker Solar Probe\")\n    thm_df = load(enc, \"THEMIS\"; dataset=\"ARTEMIS\")\n    solo_df = load(enc, \"Solo\"; dataset=\"Solar Orbiter\")\n    wind_df = load(enc, \"Wind\")\nend;\n\n\n┌ Info: Electron temperature columns not found\n└ @ Main /Users/zijin/projects/psp_conjunction/src/io.jl:61\n┌ Info: Ion temperature columns not found\n└ @ Main /Users/zijin/projects/psp_conjunction/src/io.jl:53\n┌ Info: Electron temperature columns not found\n└ @ Main /Users/zijin/projects/psp_conjunction/src/io.jl:61\n┌ Info: Ion temperature columns not found\n└ @ Main /Users/zijin/projects/psp_conjunction/src/io.jl:53\n┌ Info: Electron temperature columns not found\n└ @ Main /Users/zijin/projects/psp_conjunction/src/io.jl:61\n┌ Info: Ion temperature columns not found\n└ @ Main /Users/zijin/projects/psp_conjunction/src/io.jl:53\n┌ Info: Electron temperature columns not found\n└ @ Main /Users/zijin/projects/psp_conjunction/src/io.jl:61\nCode\n# select the time range of interest \"2021-04-29T00:45\" to \"2021-04-29T01:15\"\nfunction subset_timerange(df, start_time)\n    return subset(df, :time =&gt; t -&gt; t .&gt; DateTime(start_time))\nend\n\nfunction subset_timerange(df, start_time, end_time)\n    return subset(\n        subset_timerange(df, start_time),\n        :time =&gt; t -&gt; t .&lt; DateTime(end_time)\n    )\nend\n\n\nsubset_timerange (generic function with 2 methods)\nCode\nfunction plot_dist_comp(\n    df1, df2;\n    figure_kwargs=(size=(800, 600),)\n)\n\n    df = reduce(vcat, [df1, df2], cols=:intersect)\n    data_layer = data(df) * mapping(color=ds_mapping, marker=ds_mapping)\n\n    maps = [l_log_map j_log_map\n        l_norm_log_map j_norm_log_map]\n\n    plot_dist(data_layer; maps, axis=(), visual=mapping(), figure_kwargs=figure_kwargs)\nend\n\nfunction plot_dist_comp(df1, df2, tr1, tr2)\n    df1 = subset_timerange(df1, tr1...)\n    df2 = subset_timerange(df2, tr2...)\n    @info \"Number of data points in df1: $(nrow(df1))\"\n    @info \"Number of data points in df2: $(nrow(df2))\"\n    plot_dist_comp(df1, df2)\nend\n\n\nplot_dist_comp (generic function with 2 methods)\nCode\nplot_dist_comp(psp_df, solo_df)\nCode\nDateTime(\"2021-04-29T00:45\") + Hour(145)\nDateTime(\"2021-04-29T00:45\") + Hour(-1)\n\n\n2021-04-28T23:45:00\nCode\nbegin\n    df = reduce(\n        vcat,\n        [psp_df, thm_df, wind_df, solo_df],\n        cols=:intersect\n    )\n    levels!(df.dataset, ds_order)\n\n    earth_df = reduce(\n        vcat,\n        [thm_df, wind_df],\n        cols=:intersect\n    )\nend;\nCode\nbegin\n    # base data layer\n    data_layer = data(df) * mapping(color=ds_mapping, marker=ds_mapping)\n\n    # data layer with different alpha\n    data_layer_a = (\n        (data(thm_df) + data(wind_df)) * visual(alpha=0.3) + data(psp_df) * visual(alpha=1)\n    ) * mapping(\n        color=ds_mapping, marker=ds_mapping\n    )\n\n    # data layer with 1au missions\n    data_layer_b = (\n        (data(wind_df) + data(thm_df))\n    ) * mapping(\n        color=:dataset, marker=:dataset\n    )\nend;",
    "crumbs": [
      "Home",
      "Notebooks",
      "Results"
    ]
  },
  {
    "objectID": "notebooks/10_results.html#discontinuities-properties",
    "href": "notebooks/10_results.html#discontinuities-properties",
    "title": "Results",
    "section": "Discontinuities’ properties",
    "text": "Discontinuities’ properties\n\n\nCode\n# plot the density distribution of the thickness and current density\nbegin\n    fname = \"properties_distribution\"\n\n    maps = [l_log_map j_log_map\n        l_norm_log_map j_norm_log_map]\n    figure_kwargs = (size=(800, 600),)\n    \n    plot_dist(data_layer; maps, axis=(), visual=mapping(), figure_kwargs=figure_kwargs)\n    easy_save(fname) \nend\n\n\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/figures/enc8/properties_distribution.svg\n└ @ Beforerr /Users/zijin/.julia/dev/Beforerr/src/utils/makie.jl:45\n\n\n\n\n\n\n\nCode\nfunction plot_l_j_local_comp(df)\n    fig = Figure(size=(1000, 800))\n\n    data_layer = data(df) * mapping(col=:dataset)\n\n    facet = (; linkxaxes=:none, linkyaxes=:none)\n    # Thickness Panels\n    begin\n        plt = data_layer * mapping(di_log_map, l_log_map)\n        axis = (;)\n        draw!(fig[1, 1:3], plt, axis=axis, facet=facet)\n    end\n\n    # Current Density Panels\n    begin\n        plt = data_layer * mapping(jA_log_map, j_log_map)\n        axis = (;)\n        draw!(fig[2, 1:3], plt, axis=axis, facet=facet)\n    end\n\n    fig\nend\n\ndf |&gt; plot_l_j_local_comp\n\n\n\n\n\n\n\nCode\nbegin\n    fname = \"thickness_current\"\n\n    plt = data_layer_a * visual(Scatter)\n\n    fig = Figure(size=(1000, 500))\n    axis = log_axis\n\n    ga = fig[1, 1]\n    gb = fig[1, 2]\n\n    grid1 = plt * mapping(l_map, j_map) |&gt; draw!(ga; axis=axis)\n    grid2 = plt * mapping(l_norm_map, j_norm_map) |&gt; draw!(gb; axis=axis)\n\n    pretty_legend!(fig, grid1)\n    add_labels!([ga, gb])\n    easy_save(fname)\nend\n\n\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/figures/enc7/thickness_current.pdf\n└ @ Beforerr /Users/zijin/.julia/dev/Beforerr/src/utils/makie.jl:48\n\n\n\n\n\nggscatterhist can not handle log scale well\n\n\nCode\naxis = (limits=((-0.5, 0.5), (-0.5, 0.5)),)\n\nbegin\n    fname = \"dn-dB\"\n    plt = data_layer_a * mapping(dn_over_n, dB_over_B) * (AlgebraOfGraphics.linear() + visual(Scatter))\n    fg = draw(plt, axis=axis)\n    easy_save(fname)\nend\n\n\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/figures/enc7/dn-dB.pdf\n└ @ Beforerr /Users/zijin/.julia/dev/Beforerr/src/utils/makie.jl:48\n\n\n\n\n\n\n\nFigure 1\n\n\n\n\n\nCode\nbegin\n    fname = \"dn-dT\"\n    plt = data_layer_a * mapping(dT_over_T, dn_over_n) * (mapping())\n\n    fig = Figure(size=(1000, 500))\n    grid1 = plt |&gt; draw!(fig[1, 1])\n    grid2 = plt |&gt; draw!(fig[1, 2]; axis=(; limits=((-0.5, 0.5), (-0.5, 0.5))))\n\n    pretty_legend!(fig, grid1)\n    easy_save(fname)\n\n    fig\nend\n\n\n\n\n\nArgumentError: ArgumentError: column name \"T.change\" not found in the data frame; existing most similar names are: \"B.change\" and \"n.change\"\nArgumentError: column name \"T.change\" not found in the data frame; existing most similar names are: \"B.change\" and \"n.change\"\n\n\n\nStacktrace:\n\n  [1] lookupname\n\n    @ ~/.julia/packages/DataFrames/58MUJ/src/other/index.jl:416 [inlined]\n\n  [2] getindex\n\n    @ ~/.julia/packages/DataFrames/58MUJ/src/other/index.jl:422 [inlined]\n\n  [3] getindex(df::DataFrame, ::typeof(!), col_ind::Symbol)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/dataframe/dataframe.jl:557\n\n  [4] getcolumn\n\n    @ ~/.julia/packages/DataFrames/58MUJ/src/other/tables.jl:28 [inlined]\n\n  [5] getcolumn\n\n    @ ~/.julia/packages/DataFrames/58MUJ/src/other/tables.jl:109 [inlined]\n\n  [6] select(data::DataFrames.DataFrameColumns{DataFrame}, name::String)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/select.jl:16\n\n  [7] #133\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/select.jl:48 [inlined]\n\n  [8] map\n\n    @ ./tuple.jl:292 [inlined]\n\n  [9] select(data::DataFrames.DataFrameColumns{DataFrame}, x::Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/select.jl:48\n\n [10] (::AlgebraOfGraphics.var\"#153#156\"{DataFrames.DataFrameColumns{DataFrame}})(s::Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:77\n\n [11] iterate\n\n    @ ./generator.jl:47 [inlined]\n\n [12] _collect(c::Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0}, itr::Base.Generator{Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0}, AlgebraOfGraphics.var\"#153#156\"{DataFrames.DataFrameColumns{DataFrame}}}, ::Base.EltypeUnknown, isz::Base.HasShape{0})\n\n    @ Base ./array.jl:854\n\n [13] collect_similar(cont::Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0}, itr::Base.Generator{Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0}, AlgebraOfGraphics.var\"#153#156\"{DataFrames.DataFrameColumns{DataFrame}}})\n\n    @ Base ./array.jl:763\n\n [14] map(f::Function, A::Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0})\n\n    @ Base ./abstractarray.jl:3285\n\n [15] getlabeledarray(layer::Layer, s::Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:76\n\n [16] (::AlgebraOfGraphics.var\"#157#159\"{Layer})(v::Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:92\n\n [17] iterate\n\n    @ ./generator.jl:47 [inlined]\n\n [18] _collect(c::Vector{Any}, itr::Base.Generator{Vector{Any}, AlgebraOfGraphics.var\"#157#159\"{Layer}}, ::Base.EltypeUnknown, isz::Base.HasShape{1})\n\n    @ Base ./array.jl:854\n\n [19] collect_similar\n\n    @ ./array.jl:763 [inlined]\n\n [20] map\n\n    @ ./abstractarray.jl:3285 [inlined]\n\n [21] process_mappings(layer::Layer)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:92\n\n [22] process(layer::Layer)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:99\n\n [23] iterate\n\n    @ ./generator.jl:47 [inlined]\n\n [24] collect_to!(dest::Vector{ProcessedLayer}, itr::Base.Generator{Layers, typeof(AlgebraOfGraphics.process)}, offs::Int64, st::Int64)\n\n    @ Base ./array.jl:892\n\n [25] collect_to_with_first!(dest::Vector{ProcessedLayer}, v1::ProcessedLayer, itr::Base.Generator{Layers, typeof(AlgebraOfGraphics.process)}, st::Int64)\n\n    @ Base ./array.jl:870\n\n [26] collect(itr::Base.Generator{Layers, typeof(AlgebraOfGraphics.process)})\n\n    @ Base ./array.jl:844\n\n [27] map\n\n    @ ./abstractarray.jl:3313 [inlined]\n\n [28] ProcessedLayers(a::Layers)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:41\n\n [29] compute_axes_grid(d::Layers; axis::@NamedTuple{}, palettes::@NamedTuple{})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:114\n\n [30] compute_axes_grid\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:110 [inlined]\n\n [31] compute_axes_grid(fig::GridPosition, d::Layers; axis::@NamedTuple{}, palettes::@NamedTuple{})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:100\n\n [32] compute_axes_grid\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:97 [inlined]\n\n [33] #245\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:21 [inlined]\n\n [34] update\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:10 [inlined]\n\n [35] plot!(fig::GridPosition, d::Layers; axis::@NamedTuple{}, palettes::@NamedTuple{})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:21\n\n [36] plot!\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:16 [inlined]\n\n [37] (::AlgebraOfGraphics.var\"#252#253\"{@NamedTuple{}, @NamedTuple{}, @NamedTuple{}, Layers})(f::GridPosition)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:71\n\n [38] update\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:10 [inlined]\n\n [39] #draw!#251\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:70 [inlined]\n\n [40] draw!\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:68 [inlined]\n\n [41] #149\n\n    @ ~/projects/psp_conjunction/notebooks/utils/plot.jl:43 [inlined]\n\n [42] |&gt;(x::Layers, f::var\"#149#150\"{@NamedTuple{}, @NamedTuple{}, GridPosition})\n\n    @ Base ./operators.jl:917\n\n [43] top-level scope\n\n    @ ~/projects/psp_conjunction/notebooks/10_results.ipynb:8\n\n\n\nFigure 2\n\n\n\n\nCode\nbegin\n    fname = \"dT-dB\"\n    plt = data_layer_a * mapping(dT_over_T, dB_over_B) * (linear() + mapping())\n\n    fig = Figure(size=(1000, 500))\n    grid = draw!(fig[1, 1], plt)\n    draw!(fig[1, 2], plt, axis=(; limits=((-0.5, 0.5), (-0.5, 0.5))))\n    \n    pretty_legend!(fig, grid1)\n    easy_save(fname)\n\n    fig\nend\n\n\n\n\n\nArgumentError: ArgumentError: column name \"T.change\" not found in the data frame; existing most similar names are: \"B.change\" and \"n.change\"\nArgumentError: column name \"T.change\" not found in the data frame; existing most similar names are: \"B.change\" and \"n.change\"\n\n\n\nStacktrace:\n\n  [1] lookupname\n\n    @ ~/.julia/packages/DataFrames/58MUJ/src/other/index.jl:416 [inlined]\n\n  [2] getindex\n\n    @ ~/.julia/packages/DataFrames/58MUJ/src/other/index.jl:422 [inlined]\n\n  [3] getindex(df::DataFrame, ::typeof(!), col_ind::Symbol)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/dataframe/dataframe.jl:557\n\n  [4] getcolumn\n\n    @ ~/.julia/packages/DataFrames/58MUJ/src/other/tables.jl:28 [inlined]\n\n  [5] getcolumn\n\n    @ ~/.julia/packages/DataFrames/58MUJ/src/other/tables.jl:109 [inlined]\n\n  [6] select(data::DataFrames.DataFrameColumns{DataFrame}, name::String)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/select.jl:16\n\n  [7] #133\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/select.jl:48 [inlined]\n\n  [8] map\n\n    @ ./tuple.jl:292 [inlined]\n\n  [9] select(data::DataFrames.DataFrameColumns{DataFrame}, x::Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/select.jl:48\n\n [10] (::AlgebraOfGraphics.var\"#153#156\"{DataFrames.DataFrameColumns{DataFrame}})(s::Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:77\n\n [11] iterate\n\n    @ ./generator.jl:47 [inlined]\n\n [12] _collect(c::Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0}, itr::Base.Generator{Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0}, AlgebraOfGraphics.var\"#153#156\"{DataFrames.DataFrameColumns{DataFrame}}}, ::Base.EltypeUnknown, isz::Base.HasShape{0})\n\n    @ Base ./array.jl:854\n\n [13] collect_similar(cont::Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0}, itr::Base.Generator{Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0}, AlgebraOfGraphics.var\"#153#156\"{DataFrames.DataFrameColumns{DataFrame}}})\n\n    @ Base ./array.jl:763\n\n [14] map(f::Function, A::Array{Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}}, 0})\n\n    @ Base ./abstractarray.jl:3285\n\n [15] getlabeledarray(layer::Layer, s::Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:76\n\n [16] (::AlgebraOfGraphics.var\"#157#159\"{Layer})(v::Pair{Tuple{String, String}, Pair{typeof(/), LaTeXString}})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:92\n\n [17] iterate\n\n    @ ./generator.jl:47 [inlined]\n\n [18] _collect(c::Vector{Any}, itr::Base.Generator{Vector{Any}, AlgebraOfGraphics.var\"#157#159\"{Layer}}, ::Base.EltypeUnknown, isz::Base.HasShape{1})\n\n    @ Base ./array.jl:854\n\n [19] collect_similar\n\n    @ ./array.jl:763 [inlined]\n\n [20] map\n\n    @ ./abstractarray.jl:3285 [inlined]\n\n [21] process_mappings(layer::Layer)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:92\n\n [22] process(layer::Layer)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/processing.jl:99\n\n [23] iterate\n\n    @ ./generator.jl:47 [inlined]\n\n [24] collect_to!(dest::Vector{ProcessedLayer}, itr::Base.Generator{Layers, typeof(AlgebraOfGraphics.process)}, offs::Int64, st::Int64)\n\n    @ Base ./array.jl:892\n\n [25] collect_to_with_first!(dest::Vector{ProcessedLayer}, v1::ProcessedLayer, itr::Base.Generator{Layers, typeof(AlgebraOfGraphics.process)}, st::Int64)\n\n    @ Base ./array.jl:870\n\n [26] collect(itr::Base.Generator{Layers, typeof(AlgebraOfGraphics.process)})\n\n    @ Base ./array.jl:844\n\n [27] map\n\n    @ ./abstractarray.jl:3313 [inlined]\n\n [28] ProcessedLayers(a::Layers)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:41\n\n [29] compute_axes_grid(d::Layers; axis::@NamedTuple{}, palettes::@NamedTuple{})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:114\n\n [30] compute_axes_grid\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:110 [inlined]\n\n [31] compute_axes_grid(fig::GridPosition, d::Layers; axis::@NamedTuple{}, palettes::@NamedTuple{})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:100\n\n [32] compute_axes_grid\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/algebra/layers.jl:97 [inlined]\n\n [33] #245\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:21 [inlined]\n\n [34] update\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:10 [inlined]\n\n [35] plot!(fig::GridPosition, d::Layers; axis::@NamedTuple{}, palettes::@NamedTuple{})\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:21\n\n [36] plot!\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:16 [inlined]\n\n [37] (::AlgebraOfGraphics.var\"#252#253\"{@NamedTuple{}, @NamedTuple{}, @NamedTuple{}, Layers})(f::GridPosition)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:71\n\n [38] update\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:10 [inlined]\n\n [39] #draw!#251\n\n    @ ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:70 [inlined]\n\n [40] draw!(fig::GridPosition, d::Layers)\n\n    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/MqbNU/src/draw.jl:68\n\n [41] top-level scope\n\n    @ ~/projects/psp_conjunction/notebooks/10_results.ipynb:8\n\n\n\nFigure 3\n\n\n\n\n\nCode\nω_map = :rotation_angle =&gt; \"rotation angle (deg)\";\nv_l_ratio_map = :v_l_ratio =&gt; L\"Δ V_{ion,l} / Δ V_{A,l}\"\nplt = data(psp_df) * mapping(ω_map, v_l_ratio_map) * (linear() + visual(Scatter))\ndraw(plt)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Results"
    ]
  },
  {
    "objectID": "notebooks/10_results.html#alfvenicity",
    "href": "notebooks/10_results.html#alfvenicity",
    "title": "Results",
    "section": "Alfvenicity",
    "text": "Alfvenicity\nComparison of change in Alfven speed and plasma speed\nThe distinguishing feature of rotational discontinuities is the plasma velocity jump across them: the plasma ﬂow velocity \\(v_l\\) (the solar wind velocity projected onto l) changes due to changes in \\(B_l\\), \\(Δv_l=±Δv_A\\) with \\(v_A= B_l / \\sqrt{4 n m}\\) (Landau & Lifshitz 1960; Hudson 1970).\n\n\nCode\nfig = plot_dvl(psp_df)\n\n\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/figures/enc7/dvl.svg\n└ @ Beforerr /Users/zijin/.julia/dev/Beforerr/src/utils/makie.jl:45\n\n\n\n\n\n\n\nFigure 4\n\n\n\n\n\n\nCode\nplot_vl_ratio(df)\n\n\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/figures/enc7/vl_ratio.pdf\n└ @ Beforerr /Users/zijin/.julia/dev/Beforerr/src/utils/makie.jl:48\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/figures/enc7/vl_ratio.png\n└ @ Beforerr /Users/zijin/.julia/dev/Beforerr/src/utils/makie.jl:48\n\n\n\n\n\n\n\nCode\nvl_ratio_label = L\"\\Delta V_{i,l} / \\Delta V_{A,l}\"\nv_l_fit_ratio_map = \"v_l_fit_ratio\" =&gt; vl_ratio_label\n\nplot_vl_ratio(psp_df; mapping_args=(v_l_fit_ratio_map,), fname=missing)\n\n\n\n\n\n\n\nCode\nv_l_fit_ratio_map = \"v_l_ratio.fit.Λ_ion\" =&gt; vl_ratio_label\n\nplot_vl_ratio(psp_df; mapping_args=(v_l_fit_ratio_map,), fname=missing)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Results"
    ]
  },
  {
    "objectID": "notebooks/10_results.html#anistropy",
    "href": "notebooks/10_results.html#anistropy",
    "title": "Results",
    "section": "Anistropy",
    "text": "Anistropy\nShen et al. (2024)\n\n\nCode\nplot_anistropy_comparison_2d(psp_df)\n\n\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/figures/enc7/anisotropy_comparison_2d.pdf\n└ @ Beforerr /Users/zijin/.julia/dev/Beforerr/src/utils/makie.jl:48\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/figures/enc7/anisotropy_comparison_2d.png\n└ @ Beforerr /Users/zijin/.julia/dev/Beforerr/src/utils/makie.jl:48\n\n\n\n\n\n\n\nCode\npsp_df.Λ_ion_r = abs.(psp_df.Λ_ion ./ psp_df.Λ_t .- 1)\nfirst(sort(psp_df, :Λ_ion_r), 4)\n\n\n4×91 DataFrame\n\n\n\nRow\ntime\ntstart\ntstop\nt.d_end\nt.d_start\nt.d_time\nindex_diff\nlen\nstd\nstd_prev\nstd_next\nindex_std\nindex_fluctuation\nB.after\nB.before\nb_mag\nb_n\nbn_over_b\nd_star\ndb_mag\ndb_over_b\ndb_over_b_max\nfit.stat.chisqr\nfit.stat.rsquared\nfit.vars.amplitude\nfit.vars.c\nfit.vars.sigma\nrotation_angle\ndB_x\ndB_y\ndB_z\ndB_lmn_x\ndB_lmn_y\ndB_lmn_z\nk_x\nk_y\nk_z\nVl_x\nVl_y\nVl_z\nVn_x\nVn_y\nVn_z\nduration\nplasma_density\nv_R\nv_T\nv_N\nn.before\nv_R_before\nv_T_before\nv_N_before\nn.after\nv_R_after\nv_T_after\nv_N_after\nv_l\nv_n\nv_k\nL_k\nj0_k\nion_inertial_length\nAlfven_speed\nj_Alfven\nL_k_norm\nj0_k_norm\nv.ion.before.l\nv.ion.after.l\nB.vec.before.l\nB.vec.before.m\nB.vec.before.n\nB.vec.after.l\nB.vec.after.m\nB.vec.after.n\nv.Alfven.before\nv.Alfven.after\nv.Alfven.before.l\nv.Alfven.after.l\nn.change\nv.ion.change.l\nB.change\nv.Alfven.change\nv.Alfven.change.l\nion_temp_para\nion_temp_perp\nΛ_ion\ndataset\nB.mean\nn.mean\nΛ_t\nΛ_ion_r\n\n\n\nDateTime\nDateTime\nDateTime\nDateTime\nDateTime\nDateTime\nFloat64\nUInt32\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat32\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat32\nFloat64\nFloat64\nFloat64\nFloat32\nFloat64\nFloat64\nFloat64\nFloat32\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat32\nFloat64\nFloat64\nFloat64\nFloat64\nFloat32\nFloat32\nFloat64\nString\nFloat64\nFloat32\nFloat64\nFloat64\n\n\n\n\n1\n2021-01-17T13:23:04\n2021-01-17T13:22:56\n2021-01-17T13:23:12\n2021-01-17T13:23:11.442\n2021-01-17T13:22:59.208\n2021-01-17T13:23:05.131\n0.648186\n73\n26.5526\n10.7862\n9.1192\n2.46173\n1.16665\n101.789\n44.0335\n75.0677\n2.27744\n0.0303385\n35.13\n57.7554\n0.769377\n0.769377\n2166.56\n0.936807\n50.5067\n3.45086\n0.359427\n38.8267\n55.2233\n-46.3511\n10.8783\n-64.0992\n-34.7455\n-0.648997\n0.0884341\n-0.12652\n-0.988014\n0.357252\n-0.921461\n0.152579\n-0.0675537\n0.13744\n0.988204\n0.718854\n2732.35\n381.362\n-138.215\n3.01064\n2762.37\n379.928\n-140.686\n3.44903\n2693.38\n377.506\n-133.004\n0.147888\n264.061\n41.7835\n48.2377\n34.6759\n579.538\n4.35666\n31.3158\n13709.1\n7.95929\n0.0422739\n265.893\n257.445\n0.353517\n44.0201\n1.0304\n64.4527\n78.7656\n1.6794\n18.2693\n42.7691\n0.146672\n27.0814\n-68.9861\n8.44747\n57.7554\n24.4998\n26.9347\n64.687\n57.5403\n0.73955\nParker Solar Probe\n72.9112\n2727.87\n0.901638\n0.179771\n\n\n2\n2021-01-17T14:00:48\n2021-01-17T14:00:40\n2021-01-17T14:00:56\n2021-01-17T14:00:53.754\n2021-01-17T14:00:47.855\n2021-01-17T14:00:47.086\n0.361529\n73\n31.854\n15.1253\n6.79863\n2.106\n1.44077\n136.929\n218.531\n155.794\n-5.14073\n-0.0329971\n12.1512\n-81.6016\n0.52378\n0.52378\n3746.21\n0.592843\n115.799\n-239.374\n2.38247\n7.16678\n80.6002\n-3.1367\n24.9029\n-84.416\n-0.564816\n-0.0287437\n-0.166979\n0.75391\n0.635404\n0.953005\n-0.0410342\n0.300163\n-0.128284\n0.842916\n0.522529\n4.76494\n3863.79\n394.834\n-209.22\n91.757\n3787.03\n386.74\n-202.149\n83.7244\n3771.57\n370.53\n-189.192\n63.788\n412.406\n179.06\n165.359\n787.925\n58.4764\n3.66366\n54.6539\n33833.3\n215.065\n0.00172837\n401.991\n380.027\n-213.71\n-45.1632\n-6.63765\n-129.294\n-44.5984\n-6.60891\n77.4356\n48.6197\n-75.7273\n-45.9086\n-15.4636\n21.9645\n-81.6016\n-28.8159\n29.8187\n62.6138\n39.6508\n0.565511\nParker Solar Probe\n177.73\n3779.3\n0.45742\n0.236305\n\n\n3\n2021-01-17T14:04:16\n2021-01-17T14:04:08\n2021-01-17T14:04:24\n2021-01-17T14:04:21.940\n2021-01-17T14:04:13.421\n2021-01-17T14:04:17.681\n0.929971\n73\n41.46\n17.2032\n14.9907\n2.41002\n1.25386\n117.341\n19.9397\n95.0441\n-10.1505\n-0.106798\n-27.2953\n97.4013\n1.0248\n1.0248\n37673.6\n0.0644105\n-132.883\n0.828218\n1.21708\n140.995\n130.362\n28.4358\n0.136201\n132.883\n10.212\n6.38537\n0.164659\n-0.75789\n0.631261\n-0.968391\n-0.233127\n-0.0887121\n-0.249287\n0.916793\n0.312005\n2.43417\n3671.34\n347.46\n-127.721\n-19.1184\n3696.02\n346.453\n-129.023\n-16.8507\n3632.13\n345.098\n-126.874\n-11.6083\n-305.006\n209.676\n141.942\n345.511\n153.027\n3.75845\n34.2051\n20119.9\n91.929\n0.00760574\n-303.929\n-303.582\n17.4386\n-4.63218\n-8.4872\n-115.444\n-14.8442\n-14.8726\n7.15205\n42.4568\n6.25492\n-41.7705\n-63.8911\n0.346474\n97.4013\n35.3048\n48.0254\n52.4148\n47.751\n0.731686\nParker Solar Probe\n68.6404\n3664.07\n0.999948\n0.268276\n\n\n4\n2021-01-17T14:02:56\n2021-01-17T14:02:48\n2021-01-17T14:03:04\n2021-01-17T14:03:02.860\n2021-01-17T14:02:49.097\n2021-01-17T14:02:58.196\n1.05036\n74\n55.3271\n9.25356\n17.6372\n3.13695\n3.12493\n52.3503\n174.84\n129.15\n-5.41188\n-0.0419039\n21.6793\n-122.489\n0.948429\n0.948429\n2701.74\n0.983496\n150.598\n-163.784\n1.73666\n51.8655\n131.82\n38.9729\n55.7669\n-148.222\n-3.76153\n-4.6396\n-0.101562\n0.912044\n-0.397316\n0.894607\n0.285819\n0.34349\n0.167674\n-0.927232\n0.334853\n3.47331\n3460.77\n327.214\n-132.42\n-14.7218\n3415.25\n321.447\n-133.69\n-18.1395\n3575.76\n352.967\n-131.117\n-14.4198\n249.823\n172.719\n148.156\n514.592\n116.444\n3.87111\n47.8724\n26544.1\n132.931\n0.00438681\n243.127\n273.338\n-168.928\n44.0778\n-9.45836\n-20.7057\n47.8393\n-4.81877\n65.2389\n19.0903\n-63.033\n-7.55065\n160.513\n30.2113\n-122.489\n-46.1486\n55.4823\n63.3292\n46.3322\n0.9178\nParker Solar Probe\n113.595\n3495.51\n0.703496\n0.304626\n\n\n\n\n\n\n\n\nCode\nplot_anistropy(df)\n\n\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/notebooks/figures/anisotropy.spi_n_spi.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nplot_anistropy_theory(df)\n\n\n┌ Info: Saved /Users/zijin/projects/psp_conjunction/figures/enc7/anisotropy_theory.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nFigure 5\n\n\n\n\n\n\nCode\nfunction plot_anistropy_comparison()\n    fname = \"anisotropy_comparison\"\n\n    fig = Figure(size=(1000, 800))\n\n    plt_Λ = data(\n        stack(earth_df, [:Λ, :Λ_t, :Λ_ion, :Λ_e], [:time, :dataset])\n    ) * mapping(:value =&gt; L\"\\Lambda\", color=:variable, marker=:variable, col=:dataset)\n\n    grid1 = plt_Λ * density() |&gt; draw!$fig[1, 1:2]\n    grid2 = plt_Λ * histogram() |&gt; draw!$fig[2, 1:2]\n    # easy_save(\"$(fname)_$psp_p_instr\")\n    # legend!(fig[1, 1:2], grid, titleposition=:left, orientation=:horizontal)\n    pretty_legend!(fig, grid1)\n\n    fig\nend\n\nfunction plot_anistropy_comparison_i_e()\n    fname = \"anisotropy_comparison_i_e\"\n\n    mapping_layer = mapping(\n        Λ_e_map, Λ_ion_map,\n    )\n\n    # draw a dashed line with slope 1\n    df2 = (Λ_e=[0, 0.3], Λ_ion=[0, 0.3])\n\n    plt = (data(earth_df) * mapping(row=:dataset) + data(df2) * visual(Lines)) * mapping_layer\n\n    fig = draw(plt, facet=(; linkxaxes=:minimal, linkyaxes=:minimal))\n    fig\nend\n\n\nplot_anistropy_comparison_i_e (generic function with 1 method)\n\n\n\n\nCode\nplot_anistropy_comparison()\n\n\n\n\n\n\n\nFigure 6\n\n\n\n\n\nCode\nplot_anistropy_comparison_2d()\n\n\n\n\n\nMethodError: MethodError: no method matching plot_anistropy_comparison_2d()\n\nClosest candidates are:\n  plot_anistropy_comparison_2d(!Matched::Any)\n   @ Main ~/projects/psp_conjunction/notebooks/utils/anisotry.jl:11\n\nMethodError: no method matching plot_anistropy_comparison_2d()\n\n\n\nClosest candidates are:\n\n  plot_anistropy_comparison_2d(!Matched::Any)\n\n   @ Main ~/projects/psp_conjunction/notebooks/utils/anisotry.jl:11\n\n\n\n\n\nStacktrace:\n\n [1] top-level scope\n\n   @ ~/projects/psp_conjunction/notebooks/10_results.ipynb:3\n\n\n\nFigure 7\n\n\n\n\n\nCode\nplot_anistropy_comparison_i_e()\n\n\n\n\n\n\n\nFigure 8",
    "crumbs": [
      "Home",
      "Notebooks",
      "Results"
    ]
  },
  {
    "objectID": "notebooks/events/e7.html",
    "href": "notebooks/events/e7.html",
    "title": "Encounter 7 (2021-01-17)",
    "section": "",
    "text": "Encounter 7 (2021-01-17)\n\nWHPI - Campaign: PSP 7th Perhihelion\nENLIL Solar Wind Prediction - Parker Solar Probe - Perihelion 07\n\n\nE7 and Q3, 14–18 January, 2021.\nDuring this interval, STEREO-A, Earth, and SO will provide 360◦ coverage of the heliosphere, and just before E7, on 14 January, 2021, PSP will be in conjunction with STEREO-A, followed by conjunction with Earth on 16, E7 on 17, and quadrature Q3 on the east limb (trailing) with SO on 18 January, 2021. Synergies here arise mostly from potential remote-sensing measurements from SO and STEREO-A and from assets on the PSP–Earth line (SDO, Hinode) and ground-based instrumentation.\n\n\nThe seventh encounter of Parker Solar Probe provides observations down to 0.09 au (20.3 RS). Because of the favorable alignment between Parker and Earth, the Parker mission has teamed with theWhole Heliosphere and Planetary Interactions (WHPI) group to orgnanize another multi-observatory campaign similar to the fourth encounter of Parker. From 2021 January 10 - 20, Parker footpoint predictions will be issued on a daily basis to the community.\n\nhttps://psp-gateway.jhuapl.edu/website/SciencePlanning/Encounters/E7_ParkerSpiral_mapping.png\n\nDuring the 7th PSP perihelion passage (January 17, 2021) the Earth and many space observatories were near-radially aligned with PSP, and STEREO A was along the Parker spiral from PSP.\n\n\n\nStart Date: 20210114 End Date: 20210121\nfile:///Users/zijin/projects/autoplot/scripts/psp_mag_sw.vap?timerange=2021-01-14+through+2021-01-21\nfile:///Users/zijin/projects/autoplot/scripts/ace.vap?timerange=2021-01-15+through+2021-01-22\nfile:///Users/zijin/projects/autoplot/scripts/ace.vap?timerange=2019-04-11+through+2019-04-14\nfile:///Users/zijin/projects/autoplot/scripts/wind_plasma.vap?timerange=2019-04-08+through+2019-04-10\nfile:///Users/zijin/projects/autoplot/scripts/dscovr.vap?timerange=2019-04-08+through+2019-04-10",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events",
      "Encounter 7 (2021-01-17)"
    ]
  },
  {
    "objectID": "notebooks/events/e11.html",
    "href": "notebooks/events/e11.html",
    "title": "Encounter 11",
    "section": "",
    "text": "Encounter 11\n\nPerihelion: 2022-02-25T15:38\n\n\nE11, C6, Q8, Q9 23–27 February, 2022. PSP approaches encounter E11 beginning with a trailing quadrature Q8 on 23 February, 2022, appearing on the east limb of the Sun from SO, before rapidly going through conjunction with STEREO-A and then SO and Earth (24 and 25 February, respectively) at perihe- lion with the Earth–Sun–STEREO-A angle ’40◦ and the Earth– Sun–SO angle decreasing from ’15◦ to 0◦ on 7 March, 2022, with SO at 0.5 AU. There will be clear opportunities here for cross calibration of magnetic ﬁeld measurements, as well as a true stereoscopic reconstruction of the solar corona crossed by PSP, with opportunities for all the PSP–SO objectives.\n\n\nThe eleventh encounter of Parker Solar Probe provides observations down to 0.062 au (13.3 RS). Since the footpoints of Parker will be visible from Earth when it is near perihelion, the Parker team has again partnered with the Whole Heliosphere and Planetary Interactions (WHPI) group to coordinate remote observing during this encounter. The first footpoint prediction will be issued on February 18th followed by daily updates form February 21st through 28th, 2022. For more information, please contact Robert C. Allen (Robert.Allen@jhuapl.edu), the Parker Project Science team coordinator for this effort and visit theWHPI page for this campaign.\n\n\n\n\nfile:///Users/zijin/projects/autoplot/scripts/psp_mag_sw.vap?timerange=2022-02-22+through+2022-03-01\nfile:///Users/zijin/projects/autoplot/scripts/ace.vap?timerange=2022-02-23+through+2022-03-02\n\n\nPerihelion: 2021-04-29\nStart Date: 20210426 End Date: 20210503\nWHPI - Campaign: PSP 8th Perhihelion\n\n\nUsing a nominal 400 km/s solar wind velocity, the following figures show the ballistic mapping in a helioprojective and heliographic frame, followed by an ecliptic view of the trajectory in the frame rotating with the Earth. Several Parker spirals are drawn, showing the possible magnetic connection to the Earth near May 9th.\n\n\nE8, C2, Q4, Q5, 24 April–1 May, 2021. Throughout this period SO will be in quadrature with Earth, appearing from Earth on the solar east limb. In rapid succession over E8, PSP will appear in quadrature from SO on the east limb (trailing), then in conjunction with SO at perihelion on 28 April, with PSP at a distance of 15.5RS, then in conjunction with STEREO-A on 29 April and with Earth on 30 April. STEREO-A will be positioned trailing Earth by 45◦ midway to SO in longitude. This PSP encounter is extremely favorable to a potential joint in situ–remote-sensing campaign comprising PSP, SO, STEREOA, SDO, Hinode, and ground-based instrumentation.\n\n\nStart Date: 20210426 End Date: 20210503\nfile:///Users/zijin/projects/autoplot/scripts/psp_mag_sw.vap?timerange=2021-04-26+through+2021-05-03\nfile:///Users/zijin/projects/autoplot/scripts/ace.vap?timerange=2021-04-27+through+2021-05-04\n\n\n\nfile:///Users/zijin/projects/autoplot/scripts/ace.vap?timerange=2019-04-11+through+2019-04-14\nfile:///Users/zijin/projects/autoplot/scripts/wind_plasma.vap?timerange=2019-04-08+through+2019-04-10\nfile:///Users/zijin/projects/autoplot/scripts/dscovr.vap?timerange=2019-04-08+through+2019-04-10",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events",
      "Encounter 11"
    ]
  },
  {
    "objectID": "notebooks/events/e8.html",
    "href": "notebooks/events/e8.html",
    "title": "Encounter 8",
    "section": "",
    "text": "Encounter 8\n\nPerihelion: 2021-04-29\nStart Date: 20210426 End Date: 20210503\n\n\n\n\nWHPI - Campaign: PSP 8th Perhihelion\n\n\nUsing a nominal 400 km/s solar wind velocity, the following figures show the ballistic mapping in a helioprojective and heliographic frame, followed by an ecliptic view of the trajectory in the frame rotating with the Earth. Several Parker spirals are drawn, showing the possible magnetic connection to the Earth near May 9th.\n\n\nE8, C2, Q4, Q5, 24 April–1 May, 2021. Throughout this period SO will be in quadrature with Earth, appearing from Earth on the solar east limb. In rapid succession over E8, PSP will appear in quadrature from SO on the east limb (trailing), then in conjunction with SO at perihelion on 28 April, with PSP at a distance of 15.5RS, then in conjunction with STEREO-A on 29 April and with Earth on 30 April. STEREO-A will be positioned trailing Earth by 45◦ midway to SO in longitude. This PSP encounter is extremely favorable to a potential joint in situ–remote-sensing campaign comprising PSP, SO, STEREOA, SDO, Hinode, and ground-based instrumentation.\n\n\nStart Date: 20210426 End Date: 20210503\nfile:///Users/zijin/projects/autoplot/scripts/psp_mag_sw.vap?timerange=2021-04-26+through+2021-05-03\nfile:///Users/zijin/projects/autoplot/scripts/ace.vap?timerange=2021-04-27+through+2021-05-04\n\n\n\nfile:///Users/zijin/projects/autoplot/scripts/ace.vap?timerange=2019-04-11+through+2019-04-14\nfile:///Users/zijin/projects/autoplot/scripts/wind_plasma.vap?timerange=2019-04-08+through+2019-04-10\nfile:///Users/zijin/projects/autoplot/scripts/dscovr.vap?timerange=2019-04-08+through+2019-04-10",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events",
      "Encounter 8"
    ]
  },
  {
    "objectID": "notebooks/05_data.html",
    "href": "notebooks/05_data.html",
    "title": "Data",
    "section": "",
    "text": "Code\n%load_ext autoreload\n%autoreload 2\n\n\nThe autoreload extension is already loaded. To reload it, use:\n  %reload_ext autoreload\nCode\nfrom speasy.core.requests_scheduling.request_dispatch import init_cdaweb\nfrom space_analysis.ds.spz.plot import spz_plot",
    "crumbs": [
      "Home",
      "Notebooks",
      "Data"
    ]
  },
  {
    "objectID": "notebooks/05_data.html#parker-solar-probe-data",
    "href": "notebooks/05_data.html#parker-solar-probe-data",
    "title": "Data",
    "section": "Parker Solar Probe data",
    "text": "Parker Solar Probe data\nThe parameters are:\n\n‘psp_fld_l2_mag_RTN_4_Sa_per_Cyc’ (B in RTN, 0.25s resolution)\n‘psp_swp_spi_sf00_L3_DENS’ (Ion density, regular resolution)\n‘psp_swp_spi_af00_L3_DENS’ (Ion density, burst resolution)\n‘psp_swp_spi_sf00_L3_VEL_RTN_SUN’ (velocity in RTN in Sun’s frame, regular resolution)\n‘psp_swp_spi_af00_L3_VEL_RTN_SUN’ (velocity in RTN in Sun’s frame, burst resolution)\n‘psp_swp_spi_sf00_L3_VEL_RTN’ (velocity in RTN in spacecraft frame, regular resolution, you need this to calculate current sheet thickness)\n‘psp_swp_spi_af00_L3_VEL_RTN’ (velocity in RTN in spacecraft frame, burst resolution, you need this to calculate current sheet thickness)\n‘Tp_spani_b’ (Ion parallel and perpendicular ion temperature, regular resolution. Blue (first element in array): parallel, Red: perp)\n‘Tp_spanib_b’ (Ion parallel and perpendicular ion temperature, burst resolution. Blue (first element in array): parallel, Red: perp)\n\n\n\nCode\nfrom psp.io.psp import load_psp_data\nfrom psp.plot import preview_psp_data\n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\nCode\nenc = 8\n\n\n\n\nCode\ntnames = load_psp_data(enc)\npreview_psp_data()\n\n\n0 : psp_fld_l2_mag_RTN_4_Sa_per_Cyc\n1 : psp_swp_spi_sf00_L3_DENS\n2 : psp_swp_spi_sf00_L3_VEL_RTN_SUN\n3 : psp_swp_spi_sf00_L3_VEL_RTN\n4 : psp_swp_spi_af00_L3_DENS\n5 : psp_swp_spi_af00_L3_VEL_RTN_SUN\n6 : psp_swp_spi_af00_L3_VEL_RTN\n7 : Tp_spani_b\n8 : Tp_spanib_b\n\n\n\n\n\n\n\n\n\n\n\nCode\ninit_cdaweb()\n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\nCode\ntr = [\"2021-04-28T23:00\", \"2021-04-29T07:00\"]\nproducts = [\n    \"cda/PSP_FLD_L2_MAG_RTN_1MIN/psp_fld_l2_mag_RTN_1min\",\n    \"cda/PSP_SWP_SPI_SF00_L3_MOM/DENS\",\n    \"cda/PSP_SWP_SPI_SF00_L3_MOM/VEL_RTN_SUN\",\n    \"cda/PSP_SWP_SPI_SF00_L3_MOM/TEMP\",\n]\nspz_plot(products, tr)\n\n\n/Users/zijin/projects/psp_conjunction/.pixi/envs/default/lib/python3.11/site-packages/speasy/core/data_containers.py:17: UserWarning: no explicit representation of timezones available for np.datetime64\n  return np.searchsorted(time, np.datetime64(key, 'ns'), side='left')\n\n\n\n\n\n\n  \n\n\n\n\n\n\nCode\ntr = [\"2021-05-04T05:45:00\", \"2021-05-05T01:45:00\"]\nproducts = [\n    \"cda/SOLO_L2_MAG-RTN-NORMAL-1-MINUTE/B_RTN\",\n    \"cda/SOLO_L2_SWA-PAS-GRND-MOM/N\",\n    \"cda/SOLO_L2_SWA-PAS-GRND-MOM/V_RTN\",\n    \"cda/SOLO_L2_SWA-PAS-GRND-MOM/T\",\n]\nspz_plot(products, tr)\n\n\n/Users/zijin/projects/psp_conjunction/.pixi/envs/default/lib/python3.11/site-packages/speasy/core/data_containers.py:17: UserWarning: no explicit representation of timezones available for np.datetime64\n  return np.searchsorted(time, np.datetime64(key, 'ns'), side='left')",
    "crumbs": [
      "Home",
      "Notebooks",
      "Data"
    ]
  },
  {
    "objectID": "notebooks/05_data.html#artemis-data",
    "href": "notebooks/05_data.html#artemis-data",
    "title": "Data",
    "section": "ARTEMIS data",
    "text": "ARTEMIS data\n\nWhy sometimes we don’t have pressure tensor but have temperature tensor?\nTHB_L2_MOM\n\nthb_peem_ptens_magQ —–Electron Pressure Tensor, Field Aligned\nthb_peem_t3_magQ —–Electron Temperature, Field Aligned (TprpFA1, TprpFA2, TparFA)\nthb_peim_ptens_magQ —–Ion Pressure Tensor, Field Aligned\nthb_peim_t3_magQ —–Ion Temperature, Field Aligned (TprpFA1, TprpFA2, TparFA)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Data"
    ]
  },
  {
    "objectID": "notebooks/05_data.html#processing-data",
    "href": "notebooks/05_data.html#processing-data",
    "title": "Data",
    "section": "Processing Data",
    "text": "Processing Data\n\n\nCode\nfrom psp.config import WindConfig, THEMISConfig, SoloConfig\nfrom psp.config.psp import PSPConfig\nfrom discontinuitypy.utils.plot import plot_candidates\n\n\n\n\nCode\ninit_cdaweb()\n\n\n\n\nCode\nencs = [7, 8]\nconfigs = [PSPConfig, THEMISConfig, WindConfig, SoloConfig]\n\nfor enc in encs:\n    for cls in configs:\n        try:\n            cls(enc=enc).produce_or_load()\n        except KeyError as e:\n            print(\n                f\"Failed to produce {cls.__name__} for enc={enc} due to {e} not found in timerange\"\n            )\n            continue\n\n\n0 : psp_fld_l2_mag_RTN_4_Sa_per_Cyc\n1 : psp_swp_spi_sf00_L3_DENS\n2 : psp_swp_spi_sf00_L3_VEL_RTN_SUN\n3 : psp_swp_spi_sf00_L3_VEL_RTN\n4 : psp_swp_spi_af00_L3_DENS\n5 : psp_swp_spi_af00_L3_VEL_RTN_SUN\n6 : psp_swp_spi_af00_L3_VEL_RTN\n7 : Tp_spani_b\n8 : Tp_spanib_b\nFailed to produce SoloConfig for enc=7 due to 'solo' not found in timerange\n0 : psp_fld_l2_mag_RTN_4_Sa_per_Cyc\n1 : psp_swp_spi_sf00_L3_DENS\n2 : psp_swp_spi_sf00_L3_VEL_RTN_SUN\n3 : psp_swp_spi_sf00_L3_VEL_RTN\n4 : psp_swp_spi_af00_L3_DENS\n5 : psp_swp_spi_af00_L3_VEL_RTN_SUN\n6 : psp_swp_spi_af00_L3_VEL_RTN\n7 : Tp_spani_b\n8 : Tp_spanib_b",
    "crumbs": [
      "Home",
      "Notebooks",
      "Data"
    ]
  },
  {
    "objectID": "notebooks/05_data.html#wind-examples",
    "href": "notebooks/05_data.html#wind-examples",
    "title": "Data",
    "section": "Wind examples",
    "text": "Wind examples\n\n\nCode\nw_conf = WindConfig(enc=enc).get_data().find_events()\nplot_candidates(w_conf)\n\n\nDeprecationWarning: parsing timezone aware datetimes is deprecated; this will raise an error in the future\n2024-08-24 20:57:30.802 | INFO     | discontinuitypy.utils.plot:plot_candidates:265 - Candidates indices: [ 195  303  743 1332]\n\n\n[(&lt;Figure size 1200x500 with 1 Axes&gt;,\n  [&lt;Axes: title={'center': '#Discontinuity properties# $L: 2422.06 \\\\mathrm{km}$, $j: -0.16 \\\\mathrm{nA/m}^2$'}, ylabel='$B$\\n[nT LMN]'&gt;]),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  [&lt;Axes: title={'center': '#Discontinuity properties# $L: 200.73 \\\\mathrm{km}$, $j: 1.63 \\\\mathrm{nA/m}^2$'}, ylabel='$B$\\n[nT LMN]'&gt;]),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  [&lt;Axes: title={'center': '#Discontinuity properties# $L: 208.13 \\\\mathrm{km}$, $j: -7.57 \\\\mathrm{nA/m}^2$'}, ylabel='$B$\\n[nT LMN]'&gt;]),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  [&lt;Axes: title={'center': '#Discontinuity properties# $L: nan \\\\mathrm{km}$, $j: nan \\\\mathrm{nA/m}^2$'}, ylabel='$B$\\n[nT LMN]'&gt;])]",
    "crumbs": [
      "Home",
      "Notebooks",
      "Data"
    ]
  },
  {
    "objectID": "notebooks/05_data.html#themis-examples",
    "href": "notebooks/05_data.html#themis-examples",
    "title": "Data",
    "section": "Themis Examples",
    "text": "Themis Examples\n\n\nCode\nthm_conf = THEMISConfig(enc=enc).get_data().find_events()\nplot_candidates(thm_conf)\n\n\n24-Aug-24 20:49:47: Can't get THB_L2_MOM/thb_peim_densityQ without web service, switching to web service\nDeprecationWarning: parsing timezone aware datetimes is deprecated; this will raise an error in the future\n24-Aug-24 20:49:47: Can't get THB_L2_MOM/thb_peim_velocity_gseQ without web service, switching to web service\n24-Aug-24 20:49:47: Can't get THB_L2_MOM/thb_peim_ptotQ without web service, switching to web service\n24-Aug-24 20:49:47: Can't get THB_L2_MOM/thb_peim_densityQ without web service, switching to web service\n24-Aug-24 20:49:47: Can't get THB_L2_MOM/thb_peim_velocity_gseQ without web service, switching to web service\n24-Aug-24 20:49:47: Can't get THB_L2_MOM/thb_peim_ptotQ without web service, switching to web service\n2024-08-24 20:49:47.299 | INFO     | discontinuitypy.utils.plot:plot_candidates:265 - Candidates indices: [217 182 318 225]\n\n\n[(&lt;Figure size 1200x500 with 1 Axes&gt;,\n  [&lt;Axes: title={'center': '#Discontinuity properties# $L: 320.62 \\\\mathrm{km}$, $j: 3.94 \\\\mathrm{nA/m}^2$'}, ylabel='$B$\\n[nT LMN]'&gt;]),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  [&lt;Axes: title={'center': '#Discontinuity properties# $L: 191.30 \\\\mathrm{km}$, $j: -2.40 \\\\mathrm{nA/m}^2$'}, ylabel='$B$\\n[nT LMN]'&gt;]),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  [&lt;Axes: title={'center': '#Discontinuity properties# $L: 1841.91 \\\\mathrm{km}$, $j: 1.15 \\\\mathrm{nA/m}^2$'}, ylabel='$B$\\n[nT LMN]'&gt;]),\n (&lt;Figure size 1200x500 with 1 Axes&gt;,\n  [&lt;Axes: title={'center': '#Discontinuity properties# $L: 1271.68 \\\\mathrm{km}$, $j: -1.00 \\\\mathrm{nA/m}^2$'}, ylabel='$B$\\n[nT LMN]'&gt;])]",
    "crumbs": [
      "Home",
      "Notebooks",
      "Data"
    ]
  },
  {
    "objectID": "notebooks/01_psp_cor.html",
    "href": "notebooks/01_psp_cor.html",
    "title": "Time series correlation",
    "section": "",
    "text": "Code\nimport pyspedas\nfrom pytplot import get_data\nfrom pyspedas.analysis.tvectot import tvectot\n\nimport xarray as xr\nimport polars as pl\nimport polars.selectors as cs\n\nimport hvplot.polars  # noqa\n\nimport scipy.stats\nimport dcor\n\nimport astropy.units as u\nCode\nfrom datetimerange import DateTimeRange\nfrom sunpy.time import TimeRange\nfrom numpy import timedelta64\nfrom datetime import timedelta\nCode\nstart = \"2019-04-06T12:00\"\nend = \"2019-04-07T12:00\"\n\nearth_start = \"2019-04-09\"\nearth_end = \"2019-04-14\"\nCode\npsp_timerange = TimeRange(start, end)\n\ntimerange_earth = TimeRange(earth_start, earth_end)\nCode\ndef validate(timerange):\n    if isinstance(timerange, DateTimeRange):\n        return [timerange.get_start_time_str(), timerange.get_end_time_str()]\n    if isinstance(timerange, TimeRange):\n        return [timerange.start.to_string(), timerange.end.to_string()]",
    "crumbs": [
      "Home",
      "Notebooks",
      "Time series correlation"
    ]
  },
  {
    "objectID": "notebooks/01_psp_cor.html#estimate-of-arrival-time",
    "href": "notebooks/01_psp_cor.html#estimate-of-arrival-time",
    "title": "Time series correlation",
    "section": "Estimate of arrival time",
    "text": "Estimate of arrival time\n\n\nCode\npsp_spi_vars = pyspedas.psp.spi(trange=validate(psp_timerange), time_clip=True)\n\ntvar = tvectot(\"psp_spi_VEL_RTN_SUN\")\npsp_ion_speed: xr.DataArray = get_data(tvar, xarray=True)\n\nr_psp = get_data(\"psp_spi_SUN_DIST\", xarray=True)\n# r_psp = pl.DataFrame(r_psp.to_dataframe().reset_index())\n\n\n27-Mar-24 07:53:23: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/psp/sweap/spi/l3/spi_sf00_l3_mom/2021/\n\n\nUsing LEVEL=L3\n\n\n27-Mar-24 07:53:24: Downloading https://spdf.gsfc.nasa.gov/pub/data/psp/sweap/spi/l3/spi_sf00_l3_mom/2021/psp_swp_spi_sf00_l3_mom_20210117_v04.cdf to /Users/zijin/data/psp/sweap/spi/l3/spi_sf00_l3_mom/2021/psp_swp_spi_sf00_l3_mom_20210117_v04.cdf\n27-Mar-24 07:53:27: Download complete: /Users/zijin/data/psp/sweap/spi/l3/spi_sf00_l3_mom/2021/psp_swp_spi_sf00_l3_mom_20210117_v04.cdf\n\n\n\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\nCell In[10], line 1\n----&gt; 1 psp_spi_vars = pyspedas.psp.spi(trange=validate(psp_timerange), time_clip=True)\n      3 tvar = tvectot(\"psp_spi_VEL_RTN_SUN\")\n      4 psp_ion_speed: xr.DataArray = get_data(tvar, xarray=True)\n\nFile ~/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pyspedas/psp/__init__.py:436, in spi(trange, datatype, level, suffix, get_support_data, varformat, varnames, downloadonly, notplot, no_update, time_clip, username, password, last_version)\n    433     level = 'l3'\n    434     print(\"Using LEVEL=L3\")\n--&gt; 436 return load(instrument='spi', trange=trange, datatype=datatype, level=level, \n    437     suffix=suffix, get_support_data=get_support_data, varformat=varformat, varnames=varnames, \n    438     downloadonly=downloadonly, notplot=notplot, time_clip=time_clip, no_update=no_update, \n    439     username=username, password=password,last_version=last_version\n    440     )\n\nFile ~/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pyspedas/psp/load.py:296, in load(trange, instrument, datatype, spec_types, level, suffix, get_support_data, varformat, varnames, downloadonly, notplot, no_update, time_clip, username, password, last_version)\n    293     # we'll need the support data for the quality flags\n    294     get_support_data = True\n--&gt; 296 tvars = cdf_to_tplot(out_files, suffix=suffix, prefix=prefix, get_support_data=get_support_data, \n    297                     varformat=varformat, varnames=varnames, notplot=notplot)\n    299 if notplot:\n    300     return tvars\n\nFile ~/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/pytplot/importers/cdf_to_tplot.py:161, in cdf_to_tplot(filenames, mastercdf, varformat, exclude_format, get_support_data, get_metadata, get_ignore_data, string_encoding, prefix, suffix, plot, merge, center_measurement, notplot, varnames)\n    159 cdf_file.string_encoding = string_encoding\n    160 cdf_info = cdf_file.cdf_info()\n--&gt; 161 all_cdf_variables = cdf_info['rVariables'] + cdf_info['zVariables']\n    162 logging.debug(\"all_cdf_variables: \" + str(all_cdf_variables))\n    163 if not mastercdf_flag:\n    164     # If not using a master CDF, each CDF is its own master\n\nTypeError: 'CDFInfo' object is not subscriptable\n\n\n\n\n\nCode\ndf_info = pl.DataFrame(\n    r_psp.to_dataframe().join(psp_ion_speed.to_dataframe()).reset_index()\n)\n\n\n\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\nCell In[11], line 1\n----&gt; 1 df_info = pl.DataFrame(r_psp.to_dataframe().join(psp_ion_speed.to_dataframe()).reset_index())\n\nNameError: name 'r_psp' is not defined\n\n\n\n\n\nCode\nkm2au = u.km.to(u.AU)\nr_earth = 1 * u.AU.to(u.km)\nv_sw_slow = 250 * u.km / u.s\nv_sw_fast = 500 * u.km / u.s\n\ndf_info.sort(\"time\").group_by_dynamic(\"time\", every=\"1h\").agg(\n    cs.float().mean()\n).with_columns(\n    distance2sun=pl.col(\"psp_spi_SUN_DIST\"),\n    distance2earth=r_earth - pl.col(\"psp_spi_SUN_DIST\"),\n).with_columns(\n    dt2arrival=pl.duration(\n        seconds=pl.col(\"distance2earth\") / pl.col(\"psp_spi_VEL_RTN_SUN_tot\")\n    ),\n    dt2arrival_slow=pl.duration(seconds=pl.col(\"distance2earth\") / v_sw_slow),\n    dt2arrival_fast=pl.duration(seconds=pl.col(\"distance2earth\") / v_sw_fast),\n).with_columns(\n    time2arrival=pl.col(\"time\") + pl.col(\"dt2arrival\"),\n    time2arrival_slow=pl.col(\"time\") + pl.col(\"dt2arrival_slow\"),\n    time2arrival_fast=pl.col(\"time\") + pl.col(\"dt2arrival_fast\"),\n).with_columns(\n    distance2sun=pl.col(\"distance2sun\") * km2au,\n    distance2earth=pl.col(\"distance2earth\") * km2au,\n)\n\n\n\nshape: (24, 11)\n\n\n\ntime\npsp_spi_SUN_DIST\npsp_spi_VEL_RTN_SUN_tot\ndistance2sun\ndistance2earth\ndt2arrival\ndt2arrival_slow\ndt2arrival_fast\ntime2arrival\ntime2arrival_slow\ntime2arrival_fast\n\n\ndatetime[ns]\nf64\nf32\nf64\nf64\nduration[μs]\nduration[μs]\nduration[μs]\ndatetime[μs]\ndatetime[μs]\ndatetime[μs]\n\n\n\n\n2019-04-06 12:00:00\n2.6162e7\n289.611786\n0.174885\n0.825115\n4d 22h 23m 30s\n5d 17h 9m 1s\n2d 20h 34m 30s\n2019-04-11 10:23:30\n2019-04-12 05:09:01\n2019-04-09 08:34:30\n\n\n2019-04-06 13:00:00\n2.6231e7\n273.515167\n0.175347\n0.824653\n5d 5h 17m 20s\n5d 17h 4m 25s\n2d 20h 32m 12s\n2019-04-11 18:17:20\n2019-04-12 06:04:25\n2019-04-09 09:32:12\n\n\n2019-04-06 14:00:00\n2.6302e7\n255.006729\n0.175819\n0.824181\n5d 14h 18m 20s\n5d 16h 59m 43s\n2d 20h 29m 51s\n2019-04-12 04:18:20\n2019-04-12 06:59:43\n2019-04-09 10:29:51\n\n\n2019-04-06 15:00:00\n2.6374e7\n243.91748\n0.1763\n0.8237\n5d 20h 19m 46s\n5d 16h 54m 55s\n2d 20h 27m 27s\n2019-04-12 11:19:46\n2019-04-12 07:54:55\n2019-04-09 11:27:27\n\n\n2019-04-06 16:00:00\n2.6448e7\n244.805847\n0.176796\n0.823204\n5d 19h 44m 9s\n5d 16h 49m 58s\n2d 20h 24m 59s\n2019-04-12 11:44:09\n2019-04-12 08:49:58\n2019-04-09 12:24:59\n\n\n2019-04-06 17:00:00\n2.6523e7\n232.988617\n0.177294\n0.822706\n6d 2h 44m 4s\n5d 16h 45m\n2d 20h 22m 30s\n2019-04-12 19:44:04\n2019-04-12 09:45:00\n2019-04-09 13:22:30\n\n\n2019-04-06 18:00:00\n2.6599e7\n224.188614\n0.177805\n0.822195\n6d 8h 23m 58s\n5d 16h 39m 54s\n2d 20h 19m 57s\n2019-04-13 02:23:58\n2019-04-12 10:39:54\n2019-04-09 14:19:57\n\n\n2019-04-06 19:00:00\n2.6677e7\n222.26709\n0.178326\n0.821674\n6d 9h 37m 11s\n5d 16h 34m 42s\n2d 20h 17m 21s\n2019-04-13 04:37:11\n2019-04-12 11:34:42\n2019-04-09 15:17:21\n\n\n2019-04-06 20:00:00\n2.6757e7\n234.130203\n0.178857\n0.821143\n6d 1h 44m 30s\n5d 16h 29m 25s\n2d 20h 14m 42s\n2019-04-12 21:44:30\n2019-04-12 12:29:25\n2019-04-09 16:14:42\n\n\n2019-04-06 21:00:00\n2.6837e7\n237.631592\n0.179396\n0.820604\n5d 23h 30m\n5d 16h 24m 2s\n2d 20h 12m 1s\n2019-04-12 20:30:00\n2019-04-12 13:24:02\n2019-04-09 17:12:01\n\n\n2019-04-06 22:00:00\n2.6919e7\n307.80896\n0.179945\n0.820055\n4d 14h 42m 34s\n5d 16h 18m 34s\n2d 20h 9m 17s\n2019-04-11 12:42:34\n2019-04-12 14:18:34\n2019-04-09 18:09:17\n\n\n2019-04-06 23:00:00\n2.7003e7\n344.912201\n0.180502\n0.819498\n4d 2h 43m 58s\n5d 16h 13m\n2d 20h 6m 30s\n2019-04-11 01:43:58\n2019-04-12 15:13:00\n2019-04-09 19:06:30\n\n\n2019-04-07 00:00:00\n2.7087e7\n355.850494\n0.181069\n0.818931\n3d 23h 37m 54s\n5d 16h 7m 21s\n2d 20h 3m 40s\n2019-04-10 23:37:54\n2019-04-12 16:07:21\n2019-04-09 20:03:40\n\n\n2019-04-07 01:00:00\n2.7174e7\n392.575317\n0.181644\n0.818356\n3d 14h 37m 29s\n5d 16h 1m 37s\n2d 20h 48s\n2019-04-10 15:37:29\n2019-04-12 17:01:37\n2019-04-09 21:00:48\n\n\n2019-04-07 02:00:00\n2.7261e7\n362.412781\n0.182228\n0.817772\n3d 21h 46m 2s\n5d 15h 55m 47s\n2d 19h 57m 53s\n2019-04-10 23:46:02\n2019-04-12 17:55:47\n2019-04-09 21:57:53\n\n\n2019-04-07 03:00:00\n2.7349e7\n379.650299\n0.182819\n0.817181\n3d 17h 26m 42s\n5d 15h 49m 53s\n2d 19h 54m 56s\n2019-04-10 20:26:42\n2019-04-12 18:49:53\n2019-04-09 22:54:56\n\n\n2019-04-07 04:00:00\n2.7440e7\n395.427307\n0.183425\n0.816575\n3d 13h 48m 46s\n5d 15h 43m 51s\n2d 19h 51m 55s\n2019-04-10 17:48:46\n2019-04-12 19:43:51\n2019-04-09 23:51:55\n\n\n2019-04-07 05:00:00\n2.7530e7\n390.717957\n0.184029\n0.815971\n3d 14h 46m 58s\n5d 15h 37m 49s\n2d 19h 48m 54s\n2019-04-10 19:46:58\n2019-04-12 20:37:49\n2019-04-10 00:48:54\n\n\n2019-04-07 06:00:00\n2.7623e7\n403.930115\n0.184646\n0.815354\n3d 11h 52m 51s\n5d 15h 31m 40s\n2d 19h 45m 50s\n2019-04-10 17:52:51\n2019-04-12 21:31:40\n2019-04-10 01:45:50\n\n\n2019-04-07 07:00:00\n2.7716e7\n413.059479\n0.185271\n0.814729\n3d 9h 57m 50s\n5d 15h 25m 26s\n2d 19h 42m 43s\n2019-04-10 16:57:50\n2019-04-12 22:25:26\n2019-04-10 02:42:43\n\n\n2019-04-07 08:00:00\n2.7811e7\n388.398651\n0.185904\n0.814096\n3d 15h 6m 2s\n5d 15h 19m 8s\n2d 19h 39m 34s\n2019-04-10 23:06:02\n2019-04-12 23:19:08\n2019-04-10 03:39:34\n\n\n2019-04-07 09:00:00\n2.7907e7\n369.630157\n0.186544\n0.813456\n3d 19h 27m 4s\n5d 15h 12m 45s\n2d 19h 36m 22s\n2019-04-11 04:27:04\n2019-04-13 00:12:45\n2019-04-10 04:36:22\n\n\n2019-04-07 10:00:00\n2.8003e7\n330.248749\n0.187192\n0.812808\n4d 6h 16m 30s\n5d 15h 6m 17s\n2d 19h 33m 8s\n2019-04-11 16:16:30\n2019-04-13 01:06:17\n2019-04-10 05:33:08\n\n\n2019-04-07 11:00:00\n2.8102e7\n299.601105\n0.187847\n0.812153\n4d 16h 38m 47s\n5d 14h 59m 45s\n2d 19h 29m 52s\n2019-04-12 03:38:47\n2019-04-13 01:59:45\n2019-04-10 06:29:52",
    "crumbs": [
      "Home",
      "Notebooks",
      "Time series correlation"
    ]
  },
  {
    "objectID": "notebooks/01_psp_cor.html#get-velocity",
    "href": "notebooks/01_psp_cor.html#get-velocity",
    "title": "Time series correlation",
    "section": "Get velocity",
    "text": "Get velocity\n\n\nCode\npsp_spi_vars = pyspedas.psp.spi(trange=validate(psp_timerange), time_clip=True)\nswe_vars = pyspedas.ace.swe(trange=validate(timerange_earth), datatype=\"h0\")\n\n\n29-Jan-24 14:35:31: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/psp/sweap/spi/l3/spi_sf00_l3_mom/2019/\n\n\nUsing LEVEL=L3\n\n\n29-Jan-24 14:35:31: File is current: /Users/zijin/data/psp/sweap/spi/l3/spi_sf00_l3_mom/2019/psp_swp_spi_sf00_l3_mom_20190406_v04.cdf\n29-Jan-24 14:35:31: File is current: /Users/zijin/data/psp/sweap/spi/l3/spi_sf00_l3_mom/2019/psp_swp_spi_sf00_l3_mom_20190407_v04.cdf\n29-Jan-24 14:35:32: Downloading remote index: https://spdf.gsfc.nasa.gov/pub/data/ace/swepam/level_2_cdaweb/swe_h0/2019/\n29-Jan-24 14:35:32: File is current: /Users/zijin/data/ace/swepam/level_2_cdaweb/swe_h0/2019/ac_h0_swe_20190409_v11.cdf\n29-Jan-24 14:35:33: File is current: /Users/zijin/data/ace/swepam/level_2_cdaweb/swe_h0/2019/ac_h0_swe_20190410_v11.cdf\n29-Jan-24 14:35:33: File is current: /Users/zijin/data/ace/swepam/level_2_cdaweb/swe_h0/2019/ac_h0_swe_20190411_v11.cdf\n29-Jan-24 14:35:33: File is current: /Users/zijin/data/ace/swepam/level_2_cdaweb/swe_h0/2019/ac_h0_swe_20190412_v11.cdf\n29-Jan-24 14:35:33: File is current: /Users/zijin/data/ace/swepam/level_2_cdaweb/swe_h0/2019/ac_h0_swe_20190413_v11.cdf\n\n\n\n\nCode\ntvar = tvectot(\"psp_spi_VEL_RTN_SUN\")\npsp_ion_speed: xr.DataArray = get_data(tvar, xarray=True)\n\nace_ion_speed: xr.DataArray = get_data(\"Vp\", xarray=True)\n\n\n\n\nCode\ndef calc_correlation(\n    v1: xr.DataArray,\n    v2: xr.DataArray,\n    v1_timerange: TimeRange,\n    v2_timerange: TimeRange,\n    cadence: timedelta = timedelta(minutes=10),\n    window: timedelta = timedelta(hours=1),\n):\n    v1 = v1.dropna(\"time\").sel(\n        time=slice(v1_timerange.start.to_datetime(), v1_timerange.end.to_datetime())\n    )\n    v2 = v2.dropna(\"time\").sel(\n        time=slice(v2_timerange.start.to_datetime(), v2_timerange.end.to_datetime())\n    )\n    v1_start = v1_timerange.start.to_datetime()\n    v1_end = v1_timerange.end.to_datetime()\n\n    results = []\n    for temp_tr in v2_timerange.window(cadence=cadence, window=window):\n        v2_temp_start = temp_tr.start.to_datetime()\n        v2_temp_end = temp_tr.end.to_datetime()\n\n        v2_temp = v2.sel(time=slice(v2_temp_start, v2_temp_end))\n        v2_temp[\"time\"] = v2_temp[\"time\"] - timedelta64(v2_temp_start - v1_start)\n        v1_temp = v1.interp_like(v2_temp)\n\n        pearsonr = scipy.stats.pearsonr(v1_temp, v2_temp).statistic\n        distance_correlation = dcor.distance_correlation(v1_temp, v2_temp)\n        results.append(\n            [\n                v1_start,\n                v1_end,\n                v2_temp_start,\n                v2_temp_end,\n                pearsonr,\n                distance_correlation,\n            ]\n        )\n\n    return pl.DataFrame(\n        results,\n        schema=[\n            \"v1_start\",\n            \"v1_end\",\n            \"v2_start\",\n            \"v2_end\",\n            \"Pearson correlation\",\n            \"Distance correlation\",\n        ],\n    )\n\n\n29-Jan-24 14:35:35: /Users/zijin/micromamba/envs/psp_conjunction/lib/python3.11/site-packages/dcor/_fast_dcov_avl.py:554: UserWarning: Falling back to uncompiled AVL fast distance covariance terms because of TypeError exception raised: No matching definition for argument type(s) array(float64, 1d, C), array(float32, 1d, C), bool. Rembember: only floating point values can be used in the compiled implementations.\n  warnings.warn(\n\n\n\n\n\nCode\nwindow = psp_timerange.end - psp_timerange.start\ncadence = timedelta(minutes=10)\n\ndf = calc_correlation(\n    psp_ion_speed,\n    ace_ion_speed,\n    psp_timerange,\n    timerange_earth,\n    cadence=cadence,\n    window=window,\n)\n\n\n\n\nCode\ndf\n\n\n\nshape: (578, 6)\n\n\n\nv1_start\nv1_end\nv2_start\nv2_end\nPearson correlation\nDistance correlation\n\n\ndatetime[μs]\ndatetime[μs]\ndatetime[μs]\ndatetime[μs]\nf64\nf64\n\n\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 00:00:00\n2019-04-10 00:00:00\n0.129733\n0.295187\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 00:10:00\n2019-04-10 00:10:00\n0.115776\n0.290461\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 00:20:00\n2019-04-10 00:20:00\n0.125829\n0.295799\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 00:30:00\n2019-04-10 00:30:00\n0.134056\n0.299338\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 00:40:00\n2019-04-10 00:40:00\n0.141806\n0.309491\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 00:50:00\n2019-04-10 00:50:00\n0.137222\n0.310114\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 01:00:00\n2019-04-10 01:00:00\n0.130128\n0.307473\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 01:10:00\n2019-04-10 01:10:00\n0.132468\n0.314047\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 01:20:00\n2019-04-10 01:20:00\n0.137969\n0.310688\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 01:30:00\n2019-04-10 01:30:00\n0.153246\n0.316048\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 01:40:00\n2019-04-10 01:40:00\n0.169566\n0.320866\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-09 01:50:00\n2019-04-10 01:50:00\n0.167484\n0.325138\n\n\n…\n…\n…\n…\n…\n…\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 22:20:00\n2019-04-13 22:20:00\n-0.75871\n0.797919\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 22:30:00\n2019-04-13 22:30:00\n-0.769157\n0.807681\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 22:40:00\n2019-04-13 22:40:00\n-0.772618\n0.81499\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 22:50:00\n2019-04-13 22:50:00\n-0.78226\n0.825125\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 23:00:00\n2019-04-13 23:00:00\n-0.788294\n0.830554\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 23:10:00\n2019-04-13 23:10:00\n-0.783344\n0.829585\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 23:20:00\n2019-04-13 23:20:00\n-0.788571\n0.834751\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 23:30:00\n2019-04-13 23:30:00\n-0.787044\n0.837541\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 23:40:00\n2019-04-13 23:40:00\n-0.788278\n0.841798\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-12 23:50:00\n2019-04-13 23:50:00\n-0.785141\n0.839557\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-13 00:00:00\n2019-04-14 00:00:00\n-0.777335\n0.835922\n\n\n2019-04-06 12:00:00\n2019-04-07 12:00:00\n2019-04-13 00:10:00\n2019-04-14 00:10:00\n-0.779654\n0.840022\n\n\n\n\n\n\n\n\nCode\ndf.hvplot(\"v2_start\", [\"Pearson correlation\", \"Distance correlation\"])",
    "crumbs": [
      "Home",
      "Notebooks",
      "Time series correlation"
    ]
  },
  {
    "objectID": "article.html#comparison-of-discontinuity-properties",
    "href": "article.html#comparison-of-discontinuity-properties",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Comparison of Discontinuity Properties",
    "text": "Comparison of Discontinuity Properties\n\nThickness and current density relationship\nScale-dependent properties of current sheets in the solar wind\n\n\n\n\n\n\nFigure 2: Comparision map of (normalized) thickness and (normalized) current density\n\n\n\nVasko et al. (2022)",
    "crumbs": [
      "Home",
      "Evolution of solar wind discontinuities in the inner heliosphere"
    ]
  },
  {
    "objectID": "article.html#comparison-between-alfven-speed-and-plasma-speed-change",
    "href": "article.html#comparison-between-alfven-speed-and-plasma-speed-change",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Comparison between Alfven speed and plasma speed change",
    "text": "Comparison between Alfven speed and plasma speed change\nFor rotational discontinuities, the plasma velocity jump across them: the plasma flow velocity \\(v_l\\) (the solar wind velocity projected onto \\(l\\)) changes due to changes in \\(B_l\\), \\(Δv_l=±Δv_A\\) with \\(v_A= B_l / \\sqrt{4 n m}\\).\n\nK2: \\(Δv_l\\),l demonstrates a strong correlation with \\(Δv_{A}\\), albeit being consistently smaller.",
    "crumbs": [
      "Home",
      "Evolution of solar wind discontinuities in the inner heliosphere"
    ]
  },
  {
    "objectID": "article.html#estimated-anisotropy",
    "href": "article.html#estimated-anisotropy",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Estimated Anisotropy",
    "text": "Estimated Anisotropy\nThe equation for \\(Δv_A\\) includes a factor depending on the anisotropy of the plasma.\nPressure anisotropy \\(Λ = \\mu (P_∥ - P_⊥) / B^2\\).",
    "crumbs": [
      "Home",
      "Evolution of solar wind discontinuities in the inner heliosphere"
    ]
  },
  {
    "objectID": "article.html#comparison-between-estimated-and-observed-anisotropy",
    "href": "article.html#comparison-between-estimated-and-observed-anisotropy",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Comparison between Estimated and Observed Anisotropy",
    "text": "Comparison between Estimated and Observed Anisotropy",
    "crumbs": [
      "Home",
      "Evolution of solar wind discontinuities in the inner heliosphere"
    ]
  },
  {
    "objectID": "presentations/sparthb.html",
    "href": "presentations/sparthb.html",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "",
    "text": "Discontinuous changes in plasmas parameters and magnetic fields\n\nImport element of solar wind turbulences\nVery kinetic structure: interact with energetic part of the solar wind ions",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#solar-wind-discontinuities-swd",
    "href": "presentations/sparthb.html#solar-wind-discontinuities-swd",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "",
    "text": "Discontinuous changes in plasmas parameters and magnetic fields\n\nImport element of solar wind turbulences\nVery kinetic structure: interact with energetic part of the solar wind ions",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#formation-of-swd",
    "href": "presentations/sparthb.html#formation-of-swd",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Formation of SWD",
    "text": "Formation of SWD\nTurbulent ion heating by reconnection of tangential discontinuities. (a) Current density (color) and magnetic field lines, possible reconnection sites are indicated by crosses. (b) The proton temperature anisotropy (color) that indicates acceleration\nAlfven wave steepening results in the discontinuity formation: magnetic energy transport from large scale (Alfven waves generated in the solar corona) to small (ion kinetic) scales of discontinuities, where this energy can be dissipated to particle heating",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#motivation",
    "href": "presentations/sparthb.html#motivation",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Motivation",
    "text": "Motivation\nStudying the radial evolution of solar wind discontinuities from synergistic observations of PSP and Earth-orbiting missions (ARTEMIS, Wind) during aligned intervals.\n\nHow does the discontinuities change with the radial distance from the Sun?\nHow is solar wind discontinuities formed? What is the physical mechanisms?\n\nGenerated at or near the sun?\nLocally generated in the interplanetary space by turbulence?",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#in-situ-synergistic-observations",
    "href": "presentations/sparthb.html#in-situ-synergistic-observations",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "In-situ synergistic observations",
    "text": "In-situ synergistic observations\nSimilar type of solar wind or Same solar solar wind\nHow to define alignment?\n\nTrajectory & Orbits (theory): ballistic approximation of Parker spiral\nPlasma properties (observation):\n\nInvariants: plasma composition, ionization states, mass flux \\(n u r^2\\)\nCorrelation: magnetic field / plasma velocity\n\nSimulation: Trace plasma parcels evolution",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#orbits",
    "href": "presentations/sparthb.html#orbits",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Orbits",
    "text": "Orbits\n\n\n\n\n\n\n\n\nHeliographic frame (corotating with Sun)",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#enlil-simulation",
    "href": "presentations/sparthb.html#enlil-simulation",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "ENLIL simulation",
    "text": "ENLIL simulation\n\n\nNormalized solar wind density at the ecliptic and the IMF lines\nNormalized solar wind density at the ecliptic and the IMF lines\n\n\n\n\nRadial solar wind velocity at the ecliptic on the global and detail regions together with the temporal profile at spacecraft\nRadial solar wind velocity at the ecliptic on the global and detail regions together with the temporal profile at spacecraft",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#observation",
    "href": "presentations/sparthb.html#observation",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Observation",
    "text": "Observation\n\n\n\n\n\nPSP Observation Overvall\n\n\n\n\n\n\nPSP observation",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#observation-continued",
    "href": "presentations/sparthb.html#observation-continued",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Observation (continued)",
    "text": "Observation (continued)\n\n\n\n\n\nPSP observation\n\n\n\n\n\n\nACE observation\n\n\n\n\n\n\nACE observation (continued)\n\n\n\n\n\nTime resolution (from high to low): SPC, SPI, SQTN, QTN\nQuality (fluctuating, from high to low): SQTN, QTN, SPC/SPI\n\n\n\nDifferent Density Product",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#examples-of-discontinuities",
    "href": "presentations/sparthb.html#examples-of-discontinuities",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Examples of discontinuities",
    "text": "Examples of discontinuities\n\nIn general discontinuities observed by PSP are with\n\nshorter duration (1~5 secs)\ncompared with 5-10 secs\nlarge current density (100-1000 nA/m^2)\ncompared with 1-10 nA/m^2",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#identificationdetection-method",
    "href": "presentations/sparthb.html#identificationdetection-method",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Identification/Detection method",
    "text": "Identification/Detection method\n\nLiu et al. (2022)\nCompared with adjacent intervals without sampling",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#properties-of-discontinuities",
    "href": "presentations/sparthb.html#properties-of-discontinuities",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Properties of discontinuities",
    "text": "Properties of discontinuities\n\nEvery discontinuity’s \\(l\\) component is fitted by a \\(\\tanh\\) (logistic) function.\nCombined with plasma data (\\(n\\), \\(v\\), \\(T\\))\n\\(L\\): thickness of the discontinuity\n\\(J_0\\): maxium current density\n\nIf we expect the discontinuities to be generated locally, then the thickness of the discontinuities should be related to local plasma parameters:\n\nNormalize thickness by \\(d_i\\) (ion inertial length) or \\(r_i\\) (ion gyroradius)\nNormalize current density by \\(J_A\\) (Alfven current density)",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#plasma-adiabatic-evolution",
    "href": "presentations/sparthb.html#plasma-adiabatic-evolution",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Plasma adiabatic evolution",
    "text": "Plasma adiabatic evolution\n\n\n\n\n\n\n\nPerrone et al. (2019)",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#comparison-with-discontinuities-properties",
    "href": "presentations/sparthb.html#comparison-with-discontinuities-properties",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Comparison with discontinuities properties",
    "text": "Comparison with discontinuities properties\n\n\nK1: Normalized discontinuities properties does not vary much with radial distance\n\n\n\nK2: \\(Δv_l\\),l demonstrates a strong correlation with \\(Δv_{A}\\), albeit being consistently smaller.",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#comparison-with-alfven-speed-and-plasma-speed-change",
    "href": "presentations/sparthb.html#comparison-with-alfven-speed-and-plasma-speed-change",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Comparison with Alfven speed and plasma speed change",
    "text": "Comparison with Alfven speed and plasma speed change\nFor rotational discontinuities, the plasma velocity jump across them: the plasma ﬂow velocity \\(v_l\\) (the solar wind velocity projected onto \\(l\\)) changes due to changes in \\(B_l\\), \\(Δv_l=±Δv_A\\) with \\(v_A= B_l / \\sqrt{4 n m}\\) (Hudson 1970).",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#comparison-with-anisotropy",
    "href": "presentations/sparthb.html#comparison-with-anisotropy",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Comparison with anisotropy",
    "text": "Comparison with anisotropy\nThe equation for \\(Δv_A\\) includes a factor depending on the anisotropy of the plasma.\n\nPressure anisotropy \\(Λ = \\mu (P_∥ - P_⊥) / B^2\\).",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.html#conclusion",
    "href": "presentations/sparthb.html#conclusion",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Conclusion",
    "text": "Conclusion\n\nThe properties of the discontinuities is related to the local plasma parameters\n\nThickness =&gt; ion inertial length\nCurrent density =&gt; Alfven velocity (current density)\n\nNormalized thickness and current density of discontinuities remain constant with radial distance\nAnisotropy of the plasma is expected to be larger near the sun to explain the observed speed change ratio \\(Δv_i/Δv_A\\).",
    "crumbs": [
      "Home",
      "Presentations",
      "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations"
    ]
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#solar-wind-discontinuities-swd",
    "href": "presentations/sparthb.revealjs.html#solar-wind-discontinuities-swd",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Solar wind discontinuities (SWD)",
    "text": "Solar wind discontinuities (SWD)\nDiscontinuous changes in plasmas parameters and magnetic fields\n\nImport element of solar wind turbulences\nVery kinetic structure: interact with energetic part of the solar wind ions"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#formation-of-swd",
    "href": "presentations/sparthb.revealjs.html#formation-of-swd",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Formation of SWD",
    "text": "Formation of SWD\nTurbulent ion heating by reconnection of tangential discontinuities. (a) Current density (color) and magnetic field lines, possible reconnection sites are indicated by crosses. (b) The proton temperature anisotropy (color) that indicates acceleration\nAlfven wave steepening results in the discontinuity formation: magnetic energy transport from large scale (Alfven waves generated in the solar corona) to small (ion kinetic) scales of discontinuities, where this energy can be dissipated to particle heating"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#motivation",
    "href": "presentations/sparthb.revealjs.html#motivation",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Motivation",
    "text": "Motivation\nStudying the radial evolution of solar wind discontinuities from synergistic observations of PSP and Earth-orbiting missions (ARTEMIS, Wind) during aligned intervals.\n\nHow does the discontinuities change with the radial distance from the Sun?\nHow is solar wind discontinuities formed? What is the physical mechanisms?\n\nGenerated at or near the sun?\nLocally generated in the interplanetary space by turbulence?"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#in-situ-synergistic-observations",
    "href": "presentations/sparthb.revealjs.html#in-situ-synergistic-observations",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "In-situ synergistic observations",
    "text": "In-situ synergistic observations\nSimilar type of solar wind or Same solar solar wind\nHow to define alignment?\n\nTrajectory & Orbits (theory): ballistic approximation of Parker spiral\nPlasma properties (observation):\n\nInvariants: plasma composition, ionization states, mass flux \\(n u r^2\\)\nCorrelation: magnetic field / plasma velocity\n\nSimulation: Trace plasma parcels evolution"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#orbits",
    "href": "presentations/sparthb.revealjs.html#orbits",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Orbits",
    "text": "Orbits\n\n\n\n\n\n\n\n\nHeliographic frame (corotating with Sun)"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#enlil-simulation",
    "href": "presentations/sparthb.revealjs.html#enlil-simulation",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "ENLIL simulation",
    "text": "ENLIL simulation\n\n\nVideo\nNormalized solar wind density at the ecliptic and the IMF lines\n\n\n\n\nVideo\nRadial solar wind velocity at the ecliptic on the global and detail regions together with the temporal profile at spacecraft"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#observation",
    "href": "presentations/sparthb.revealjs.html#observation",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Observation",
    "text": "Observation\n\n\n\n\n\nPSP Observation Overvall\n\n\n\n\n\n\nPSP observation"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#observation-continued",
    "href": "presentations/sparthb.revealjs.html#observation-continued",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Observation (continued)",
    "text": "Observation (continued)\n\n\n\n\n\nPSP observation\n\n\n\n\n\n\nACE observation\n\n\n\n\n\n\nACE observation (continued)"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#examples-of-discontinuities",
    "href": "presentations/sparthb.revealjs.html#examples-of-discontinuities",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Examples of discontinuities",
    "text": "Examples of discontinuities\n\nIn general discontinuities observed by PSP are with\n\nshorter duration (1~5 secs)\ncompared with 5-10 secs\nlarge current density (100-1000 nA/m^2)\ncompared with 1-10 nA/m^2"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#identificationdetection-method",
    "href": "presentations/sparthb.revealjs.html#identificationdetection-method",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Identification/Detection method",
    "text": "Identification/Detection method\n\nLiu et al. (2022)\nCompared with adjacent intervals without sampling"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#properties-of-discontinuities",
    "href": "presentations/sparthb.revealjs.html#properties-of-discontinuities",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Properties of discontinuities",
    "text": "Properties of discontinuities\n\nEvery discontinuity’s \\(l\\) component is fitted by a \\(\\tanh\\) (logistic) function.\nCombined with plasma data (\\(n\\), \\(v\\), \\(T\\))\n\\(L\\): thickness of the discontinuity\n\\(J_0\\): maxium current density"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#plasma-adiabatic-evolution",
    "href": "presentations/sparthb.revealjs.html#plasma-adiabatic-evolution",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Plasma adiabatic evolution",
    "text": "Plasma adiabatic evolution\n\n\n\n\n\n\n\nPerrone et al. (2019)"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#comparison-with-discontinuities-properties",
    "href": "presentations/sparthb.revealjs.html#comparison-with-discontinuities-properties",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Comparison with discontinuities properties",
    "text": "Comparison with discontinuities properties\n\n\nK1: Normalized discontinuities properties does not vary much with radial distance"
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#comparison-with-alfven-speed-and-plasma-speed-change",
    "href": "presentations/sparthb.revealjs.html#comparison-with-alfven-speed-and-plasma-speed-change",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Comparison with Alfven speed and plasma speed change",
    "text": "Comparison with Alfven speed and plasma speed change\nFor rotational discontinuities, the plasma velocity jump across them: the plasma ﬂow velocity \\(v_l\\) (the solar wind velocity projected onto \\(l\\)) changes due to changes in \\(B_l\\), \\(Δv_l=±Δv_A\\) with \\(v_A= B_l / \\sqrt{4 n m}\\) (Hudson 1970)."
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#comparison-with-anisotropy",
    "href": "presentations/sparthb.revealjs.html#comparison-with-anisotropy",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Comparison with anisotropy",
    "text": "Comparison with anisotropy\nThe equation for \\(Δv_A\\) includes a factor depending on the anisotropy of the plasma.\n\nPressure anisotropy \\(Λ = \\mu (P_∥ - P_⊥) / B^2\\)."
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#conclusion",
    "href": "presentations/sparthb.revealjs.html#conclusion",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "Conclusion",
    "text": "Conclusion\n\nThe properties of the discontinuities is related to the local plasma parameters\n\nThickness =&gt; ion inertial length\nCurrent density =&gt; Alfven velocity (current density)\n\nNormalized thickness and current density of discontinuities remain constant with radial distance\nAnisotropy of the plasma is expected to be larger near the sun to explain the observed speed change ratio \\(Δv_i/Δv_A\\)."
  },
  {
    "objectID": "presentations/sparthb.revealjs.html#references",
    "href": "presentations/sparthb.revealjs.html#references",
    "title": "Solar Wind Discontinuities: Parker Solar Probe vs ARTEMIS Observations",
    "section": "References",
    "text": "References\n\n\n\n\n\n\n\n\nHudson, P. D. 1970. “Discontinuities in an Anisotropic Plasma and Their Identification in the Solar Wind.” Planetary and Space Science 18 (11): 1611–22. https://doi.org/10.1016/0032-0633(70)90036-X.\n\n\nLiu, Y. Y., H. S. Fu, J. B. Cao, Z. Wang, R. J. He, Z. Z. Guo, Y. Xu, and Y. Yu. 2022. “Magnetic Discontinuities in the Solar Wind and Magnetosheath: Magnetospheric Multiscale Mission (MMS) Observations.” Astrophysical Journal 930 (1): 63. https://doi.org/10.3847/1538-4357/ac62d2.\n\n\nPerrone, Denise, D Stansby, T S Horbury, and L Matteini. 2019. “Radial Evolution of the Solar Wind in Pure High-Speed Streams: HELIOS Revised Observations.” Monthly Notices of the Royal Astronomical Society 483 (3): 3730–37. https://doi.org/10.1093/mnras/sty3348."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "",
    "text": "Studying the radial evolution of solar wind discontinuities from synergistic observations of PSP and Earth-orbiting missions (ARTEMIS, Wind) during aligned intervals.\n\nHow does the discontinuities change with the radial distance from the Sun?\nHow is solar wind discontinuities formed? What is the physical mechanisms?\n\nGenerated at or near the sun?\nLocally generated in the interplanetary space by turbulence?"
  },
  {
    "objectID": "index.html#in-situ-synergistic-observations-alignment",
    "href": "index.html#in-situ-synergistic-observations-alignment",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "In-situ synergistic observations (Alignment)",
    "text": "In-situ synergistic observations (Alignment)\nSimilar type of solar wind or Same solar solar wind\nHow to define alignment?\n\nTrajectory & Orbits (theory): ballistic approximation of Parker spiral\nPlasma properties (observation):\n\nInvariants: plasma composition, ionization states, mass flux \\(n u r^2\\)\nCorrelation: magnetic field / plasma velocity\n\nSimulation: Trace plasma parcels evolution\n\n\n\nHigh-speed solar wind radial evolution\n\n\n\n\n\n\n\nPerrone et al. (2019)\n\n\n\nThe radial dependence of the proton number density, \\(n_p\\) and magnetic ﬁeld magnitude, \\(B\\), is given by\n\\[\nn_p = (2.4 ± 0.1)(R/R_0)^{−(1.96±0.07)} cm^{−3}\n\\\\\nB = (5.7 ± 0.2)(R/R_0)^{−(1.59±0.06)} nT\n\\]\nThe faster decrease of the magnetic than kinetic pressure is reﬂected in the radial proton plasma beta variation\n\\[\nβ_p = P_k/P_B = (0.55 ± 0.04)(R/R_0)^{(0.4±0.1)}\n\\]"
  },
  {
    "objectID": "index.html#examples-of-discontinuities",
    "href": "index.html#examples-of-discontinuities",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Examples of discontinuities",
    "text": "Examples of discontinuities\n\nIn general discontinuities observed by PSP are with\n\nshorter duration (1~5 secs)\ncompared with 5-10 secs\nlarge current density (100-1000 nA/m^2)\ncompared with 1-10 nA/m^2"
  },
  {
    "objectID": "index.html#comparison-of-discontinuity-properties",
    "href": "index.html#comparison-of-discontinuity-properties",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Comparison of Discontinuity Properties",
    "text": "Comparison of Discontinuity Properties\n\n\nK1: Normalized discontinuities properties does not vary much with radial distance"
  },
  {
    "objectID": "index.html#comparison-between-alfven-speed-and-plasma-speed-change",
    "href": "index.html#comparison-between-alfven-speed-and-plasma-speed-change",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Comparison between Alfven speed and plasma speed change",
    "text": "Comparison between Alfven speed and plasma speed change\nFor rotational discontinuities, the plasma velocity jump across them: the plasma flow velocity \\(v_l\\) (the solar wind velocity projected onto \\(l\\)) changes due to changes in \\(B_l\\), \\(Δv_l=±Δv_A\\) with \\(v_A= B_l / \\sqrt{4 n m}\\).\n\nK2: \\(Δv_l\\),l demonstrates a strong correlation with \\(Δv_{A}\\), albeit being consistently smaller."
  },
  {
    "objectID": "index.html#estimated-anisotropy",
    "href": "index.html#estimated-anisotropy",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Estimated Anisotropy",
    "text": "Estimated Anisotropy\nThe equation for \\(Δv_A\\) includes a factor depending on the anisotropy of the plasma.\nPressure anisotropy \\(Λ = \\mu (P_∥ - P_⊥) / B^2\\)."
  },
  {
    "objectID": "index.html#comparison-between-estimated-and-observed-anisotropy",
    "href": "index.html#comparison-between-estimated-and-observed-anisotropy",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Comparison between Estimated and Observed Anisotropy",
    "text": "Comparison between Estimated and Observed Anisotropy"
  },
  {
    "objectID": "index.html#anistropy",
    "href": "index.html#anistropy",
    "title": "Evolution of solar wind discontinuities in the inner heliosphere",
    "section": "Anistropy",
    "text": "Anistropy\nShen et al. (2024)\npressure anisotropy is defined as \\(Λ = \\mu (P_∥ - P_⊥) / B^2\\)."
  },
  {
    "objectID": "notes.html",
    "href": "notes.html",
    "title": "Updates",
    "section": "",
    "text": "Why ARTEMIS electron data and Wind ion data?\nDisagreement between anisotropy observed and predicted by the theory\n\nmaybe just too localized anisotropy that is not well measured with available time resolution…\nor maybe more complex ion distribution, where nongyrotropy is more important than anisotropy\n# TODO\n\nPlot Bl(t), jm(l) and ion anisotropy for these cases?\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPair plot\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGiven timeseries \\((R_a, \\phi_a\\), \\(R_b(t)\\),",
    "crumbs": [
      "Home",
      "Updates"
    ]
  },
  {
    "objectID": "notes.html#encounter-2",
    "href": "notes.html#encounter-2",
    "title": "Updates",
    "section": "",
    "text": "Pair plot",
    "crumbs": [
      "Home",
      "Updates"
    ]
  },
  {
    "objectID": "notes.html#section",
    "href": "notes.html#section",
    "title": "Updates",
    "section": "",
    "text": "Given timeseries \\((R_a, \\phi_a\\), \\(R_b(t)\\),",
    "crumbs": [
      "Home",
      "Updates"
    ]
  },
  {
    "objectID": "notebooks/00_notes.html",
    "href": "notebooks/00_notes.html",
    "title": "Notes",
    "section": "",
    "text": "Code\nimport polars as pl\nfrom beforerr.project import datadir\n\n\n\n\nCode\ndf = pl.read_csv(datadir() / \"psp_events.csv\", try_parse_dates=True)\ndf.to_pandas()\n\n\n\n\nTable 1: PSP events\n\n\n\n\n\n\n\n\n\n\nEvent\nDistance (R_sun)\nTime\nNotes\n\n\n\n\n0\nE1\n35.6\n2018-11-06 03:27:00\nPerihelion\n\n\n1\nE2\n35.6\n2019-04-04 22:39:00\nPerihelion\n\n\n2\nE3\n35.6\n2019-09-01 17:50:00\nPerihelion\n\n\n3\nE4\n27.8\n2020-01-29 09:37:00\nPerihelion\n\n\n4\nE5\n27.8\n2020-06-07 08:23:00\nPerihelion\n\n\n5\nE6\n20.3\n2020-09-27 09:16:00\nPerihelion\n\n\n6\nE7\n20.3\n2021-01-17 17:40:00\nPerihelion\n\n\n7\nE8\n15.9\n2021-04-29 08:48:00\nPerihelion\n\n\n8\nE9\n15.9\n2021-08-09 19:11:00\nPerihelion\n\n\n9\nE10\n13.3\n2021-11-21 08:23:00\nPerihelion\n\n\n10\nE11\n13.3\n2022-02-25 15:38:00\nPerihelion\n\n\n11\nE12\n13.3\n2022-06-01 22:51:00\nPerihelion\n\n\n12\nE13\n13.3\n2022-09-06 06:04:00\nPerihelion\n\n\n13\nE14\n13.3\n2022-12-11 13:16:00\nPerihelion\n\n\n14\nE15\n13.3\n2023-03-17 20:30:00\nPerihelion\n\n\n15\nE16\n13.3\n2023-06-22 03:46:00\nPerihelion\n\n\n16\nE17\n11.4\n2023-09-27 23:28:00\nPerihelion\n\n\n17\nE18\n11.4\n2023-12-29 00:54:00\nPerihelion\n\n\n18\nE19\n11.4\n2024-03-30 02:20:00\nPerihelion\n\n\n19\nE20\n11.4\n2024-06-30 03:46:00\nPerihelion\n\n\n20\nE21\n11.4\n2024-09-30 05:13:00\nPerihelion\n\n\n21\nE22\n9.9\n2024-12-24 11:41:00\nPerihelion\n\n\n22\nE23\n9.9\n2025-03-22 22:25:00\nPerihelion\n\n\n23\nE24\n9.9\n2025-06-19 09:09:00\nPerihelion\n\n\n\n\n\n\n\n\n\n\n\nAnisotropy\n\nPSP_SWP_SPI_SF00_L3_MOM\n\nNotes: Partial moments of the Proton distribution function in the SPAN-Ion instrument, PSP spacecraft, and RTN coordinate systems. User should be aware that the full ion distribution is typically NOT in the FOV of the instrument.\nT_TENSOR Partial Moment Temperature Tensor in instrument frame\n\nWI_H0_SWE\n\nTe_anisotropy Temperature anisotropy = Te_para / Te_perp\n\nWI_PLSP_3DP\n\nMOM.P.MAGT3 —&gt; [P.SYMM_MAGT3] Proton temperature tensor… rotated into a field-aligned coordinate basis and then taking the diagonal elements only\n\nWI_ELM2_3DP : Wind 3dp, PESA Low (~24 sec resolution) energy spectra with ion moments\n\nMAGT3 —&gt; [MAGT3] electron temperature tensor… rotated into a field-aligned coordinate basis and then taking the diagonal elements only\n\nTHB_L2_ESA\n\nthb_peeb_magt3Q —–Electron Temperature, Field Aligned (Tprp1FA, Tprp2FA, TparFA)\nthb_peef_magt3Q —–Electron Temperature, Field Aligned (Tprp1FA, Tprp2FA, TparFA)\nthb_peif_magt3Q —–Temperature, Field Aligned (TprpFA1, TprpFA2, TparFA)\n\nTHB_L2_MOM\n\nthb_peem_ptens_magQ —–Electron Pressure Tensor, Field Aligned\nthb_peem_t3_magQ —–Electron Temperature, Field Aligned (TprpFA1, TprpFA2, TparFA)\nthb_peim_ptens_magQ —–Ion Pressure Tensor, Field Aligned\nthb_peim_t3_magQ —–Ion Temperature, Field Aligned (TprpFA1, TprpFA2, TparFA)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Notes"
    ]
  },
  {
    "objectID": "notebooks/01_psp_overview.html",
    "href": "notebooks/01_psp_overview.html",
    "title": "Overview of the event",
    "section": "",
    "text": "We are using PSP_SWP_SPI_SF00_L3_MOM dataset\nDSCOVR_H1_FC/Np outside of its definition range &lt;DateTimeRange: 2016-06-03T00:00:00+00:00 -&gt; 2019-06-27T23:58:59+00:00&gt;\nCode\n# hvplot.extension('bokeh', 'matplotlib')\n# hvplot.output(backend='matplotlib', fig='svg')\nCode\npsp_dataset = \"PSP_SWP_SPI_SF00_L3_MOM\"\npsp_parameters = [\"DENS\", \"VEL_RTN_SUN\", \"TEMP\", \"MAGF_SC\", \"SUN_DIST\"]\nCode\n# Encounter 2\npsp_start = \"2019-04-07T01:00\"\npsp_end = \"2019-04-07T09:00\"\n\nearth_start = \"2019-04-09\"\nearth_end = \"2019-04-14\"\n\nevery = timedelta(minutes=4)\n\nmission = \"Wind\"\n# mission = \"DSCOVR\"\n\nfname = f\"../figures/evolution/plasma-adiabatic-evolution_e2-{mission}\"\nCode\n# # Encounter 4\n# psp_start = '2020-01-27'\n# psp_end = '2020-01-29'\n\n# earth_start = '2020-01-29'\n# earth_end = '2020-01-31'\n\n# every = timedelta(minutes=4)\n\n# mission = 'Wind'\n\n# fname = f\"../figures/evolution/plasma-adiabatic-evolution_e4-{mission}\"\nCode\npsp_timerange = TimeRange(psp_start, psp_end)\n\nearth_timerange = TimeRange(earth_start, earth_end)\nCode\nmatch mission.lower():\n    case \"dscovr\":\n        e_mag_dataset = \"DSCOVR_H0_MAG\"\n        e_mag_parameters = [\"B1F1\"]\n        e_plasma_dataset = \"DSCOVR_H1_FC\"\n        e_plasma_parameters = [\"Np\", \"V_GSE\", \"THERMAL_TEMP\"]\n    case \"wind\":\n        e_mag_dataset = \"WI_K0_MFI\"\n        e_mag_parameters = [\"BF1\"]\n        e_plasma_dataset = \"WI_K0_SWE\"\n        e_plasma_parameters = [\"Np\", \"V_GSM\", \"THERMAL_SPD\"]\nCode\ndef validate(timerange):\n    if isinstance(timerange, TimeRange):\n        return [timerange.start.to_string(), timerange.end.to_string()]\nCode\npsp_plasma_vars = Variables(\n    dataset=psp_dataset, parameters=psp_parameters, timerange=validate(psp_timerange)\n).retrieve_data()\n\nvec_cols = psp_plasma_vars.data[1].columns\npsp_mag_cols = psp_plasma_vars.data[3].columns\nCode\ndef preview(products: list[str]):\n    vars = Variables(\n        products=products, timerange=validate(earth_timerange)\n    ).retrieve_data()\n\n    fig, axes = plt.subplots(2)\n    vars.data[0].replace_fillval_by_nan().plot(ax=axes[0])\n    vars.data[1].replace_fillval_by_nan().plot(ax=axes[1])\n\n    return fig, axes\n\n\n# preview([\"cda/DSCOVR_H1_FC/THERMAL_TEMP\", \"cda/WI_K0_SWE/THERMAL_SPD\"])\n# preview([\"cda/DSCOVR_H0_MAG/B1F1\", \"cda/WI_K0_MFI/BF1\"])\nCode\nvars = Variables(\n    products=[\"cda/DSCOVR_H1_FC/THERMAL_TEMP\", \"cda/WI_K0_SWE/THERMAL_SPD\"],\n    timerange=validate(earth_timerange),\n).retrieve_data()",
    "crumbs": [
      "Home",
      "Notebooks",
      "Overview of the event"
    ]
  },
  {
    "objectID": "notebooks/01_psp_overview.html#radial-evolution-of-the-coronal-hole-high-speed-streams",
    "href": "notebooks/01_psp_overview.html#radial-evolution-of-the-coronal-hole-high-speed-streams",
    "title": "Overview of the event",
    "section": "Radial evolution of the coronal hole high-speed streams",
    "text": "Radial evolution of the coronal hole high-speed streams\nPerrone et al. (2019) used HELIOS observations to study the radial evolution of the solar wind in coronal hole high-speed streams. They found that The radial dependence of the proton number density, np, and the magnetic field, B, is given by\nThe radial dependence of the proton number density, np is\n\\[n_p = (2.4 ± 0.1)(R/R_0)^{−(1.96±0.07)} cm^{−3}\\]\n\\[B = (5.7 ± 0.2)(R/R_0)^{−(1.59±0.06)} nT\\]\nThe faster decrease of the magnetic than kinetic pressure is reﬂected in the radial proton plasma beta variation\n\\[β_p = P_k/P_B = (0.55 ± 0.04)(R/R_0)^{(0.4±0.1)}.\\]\nThe behaviour of the parallel proton plasma beta is similar\n\\[β_{‖} = (0.37 ± 0.03)(R/R_0)^{(0.8±0.1)}\\]\n\n\nCode\ndef plasma_r_evolution(\n    df: pl.DataFrame,\n    alpha_beta_r=0.4,\n    alpha_beta_parallel_r=0.9,\n    alpha_n=-2,\n    alpha_B=-1.63,\n    alpha_plasma_speed=0,\n):\n    return df.with_columns(\n        plasma_speed_1AU=pl.col(\"plasma_speed\")\n        * (1 / pl.col(\"distance2sun\")) ** alpha_plasma_speed,\n        n_1AU=pl.col(\"n\") * (1 / pl.col(\"distance2sun\")) ** alpha_n,\n        B_1AU=pl.col(\"B\") * (1 / pl.col(\"distance2sun\")) ** alpha_B,\n        beta_1AU=pl.col(\"beta\") * (1 / pl.col(\"distance2sun\")) ** alpha_beta_r,\n        beta_parallel=pl.col(\"beta\")\n        * (1 / pl.col(\"distance2sun\")) ** alpha_beta_parallel_r,\n    )\n\n\n\n\nCode\nkm2au = u.km.to(u.AU)\n\n\n\n\nCode\npsp_plasma_r = (\n    psp_plasma_vars.to_polars()\n    .pipe(resample, every)\n    .with_columns(\n        B=pl_norm(psp_mag_cols),\n        plasma_speed=pl_norm(vec_cols),\n        distance2sun=pl.col(\"Sun Distance\") * km2au,\n    )\n    .rename(\n        {\n            \"Density\": \"n\",\n            \"Temperature\": \"T\",\n        }\n    )\n    .collect()\n    .pipe(df_beta)\n    .pipe(plasma_r_evolution)\n    .pipe(df_Alfven_speed)\n    .pipe(df_Alfven_speed, B=\"B_1AU\", n=\"n_1AU\", col_name=\"Alfven_speed_1AU\")\n    .with_columns(\n        plasma_speed_over_Alfven_speed=pl.col(\"plasma_speed\") / pl.col(\"Alfven_speed\"),\n        plasma_speed_over_Alfven_speed_1AU=pl.col(\"plasma_speed_1AU\")\n        / pl.col(\"Alfven_speed_1AU\"),\n    )\n)\n\n\n\n\nCode\ndef thermal_spd2temp(speed, speed_unit=u.km / u.s):\n    return (m_p * (speed * speed_unit) ** 2 / 2).to(\"eV\").value\n\n\ndef df_thermal_spd2temp(\n    ldf: pl.LazyFrame,\n    speed_col,\n    speed_unit=u.km / u.s,\n    name=\"plasma_temperature\",\n    temp_unit=u.eV,\n):\n    df = ldf.collect()\n    temp = thermal_spd2temp(df[speed_col].to_numpy(), speed_unit)\n    return df.with_columns(pl.Series(temp).alias(name)).lazy()\n\n\n\n\nCode\ndef process(\n    timerange,\n    mag_dataset: str,\n    mag_parameters: list[str],\n    plasma_dataset: str,\n    plasma_parameters: list[str],\n):\n    timerange = validate(timerange)\n\n    mag_vars = Variables(\n        dataset=mag_dataset,\n        parameters=mag_parameters,\n        timerange=timerange,\n    ).retrieve_data()\n\n    plasma_vars = Variables(\n        dataset=plasma_dataset,\n        parameters=plasma_parameters,\n        timerange=timerange,\n    ).retrieve_data()\n\n    temp_vars = plasma_vars.data[2]\n\n    density_col = plasma_vars.data[0].columns[0]\n    vec_cols = plasma_vars.data[1].columns\n    temp_col = temp_vars.columns[0]\n    mag_col = mag_vars.data[0].columns[0]\n\n    plasma_data = (\n        plasma_vars.to_polars()\n        .with_columns(plasma_speed=pl_norm(vec_cols))\n        .rename({density_col: \"n\"})\n    ).pipe(resample, every)\n    # process temperature data\n\n    if temp_vars.unit == \"km/s\":\n        plasma_data = plasma_data.pipe(df_thermal_spd2temp, temp_col, name=\"T\")\n        T_unit = u.eV\n    else:\n        plasma_data = plasma_data.rename({temp_col: \"T\"})\n        if temp_vars.unit.startswith(\"K\"):\n            T_unit = u.K\n\n    mag_data = mag_vars.to_polars().pipe(resample, every).rename({mag_col: \"B\"})\n\n    df = (\n        plasma_data.sort(\"time\")\n        .join_asof(mag_data.sort(\"time\"), on=\"time\")\n        .collect()\n        .pipe(df_beta, T_unit=T_unit)\n        .pipe(df_Alfven_speed)\n        .with_columns(\n            plasma_speed_over_Alfven_speed=pl.col(\"plasma_speed\")\n            / pl.col(\"Alfven_speed\"),\n        )\n    )\n    return df\n\n\n\n\nCode\nfrom copy import deepcopy\n\n\n\n\nCode\nfunc = partial(\n    process,\n    mag_dataset=e_mag_dataset,\n    mag_parameters=e_mag_parameters,\n    plasma_dataset=e_plasma_dataset,\n    plasma_parameters=e_plasma_parameters,\n)\n\n\n\n\nCode\ne_df_previous = func(deepcopy(earth_timerange).previous())\ne_df = func(earth_timerange)\ne_df_next = func(deepcopy(earth_timerange).next())\n\n\n\n\nCode\nplot = psp_plasma_r.plot(\n    x=\"time\",\n    y=[\"plasma_speed\", \"beta\", \"Alfven_speed\", \"plasma_speed_over_Alfven_speed\"],\n    subplots=True,\n    shared_axes=False,\n).cols(1)\n\nplot_1AU = psp_plasma_r.plot(\n    x=\"time\",\n    y=[\n        \"plasma_speed_1AU\",\n        \"beta_1AU\",\n        \"Alfven_speed_1AU\",\n        \"plasma_speed_over_Alfven_speed_1AU\",\n    ],\n    subplots=True,\n    shared_axes=False,\n).cols(1)\n\nplot + plot_1AU\n\n\nCannot render NdLayout nested inside a Layout\n\n\n:Layout\n   .NdLayout.I  :NdLayout   [Variable]\n      :Curve   [time]   (value)\n   .NdLayout.II :NdLayout   [Variable]\n      :Curve   [time]   (value)\n\n\n\n\nCode\ndef compare_df(df1, df2):\n    df1_plot = df1.plot.scatter(\n        x=\"beta\", y=\"plasma_speed_over_Alfven_speed\", label=\"PSP\"\n    ) * df1.plot.scatter(\n        x=\"beta_1AU\",\n        y=\"plasma_speed_over_Alfven_speed_1AU\",\n        label=\"PSP (1AU predicted)\",\n    )\n\n    df2_plot = df2.plot.scatter(\n        x=\"beta\",\n        y=\"plasma_speed_over_Alfven_speed\",\n        label=mission,\n        alpha=0.2,\n    )\n\n    xlabel = \"Plasma beta\"\n    # ylabel=r\"$v_i$ / $v_A$\"\n    ylabel = \"Plasma speed over Alfven speed\"\n\n    return (df2_plot * df1_plot).opts(\n        xlabel=xlabel, ylabel=ylabel, logx=True, logy=True\n    )\n\n\n\n\nCode\nhvplot.extension(\"bokeh\", \"matplotlib\")\nhvplot.output(backend=\"matplotlib\", fig=\"svg\")\n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\nCode\nfig = compare_df(psp_plasma_r, e_df_previous).opts(title=\"Previous Period\")\nhvplot.save(fig, fname + \"-previous\", fmt=\"svg\")\n# hvplot.save(fig, fname + \"-previous.svg\")\n\n\n\n\nCode\nfig = compare_df(psp_plasma_r, e_df).opts(title=\"Current Period\")\nhvplot.save(fig, fname, fmt=\"svg\")\n\n\n\n\nCode\nfig = compare_df(psp_plasma_r, e_df_next).opts(title=\"Next Period\")\nhvplot.save(fig, fname + \"-next\", fmt=\"svg\")",
    "crumbs": [
      "Home",
      "Notebooks",
      "Overview of the event"
    ]
  },
  {
    "objectID": "notebooks/01_psp_overview.html#datetime-slider",
    "href": "notebooks/01_psp_overview.html#datetime-slider",
    "title": "Overview of the event",
    "section": "Datetime slider",
    "text": "Datetime slider\n\n\nCode\nimport panel as pn\n\n\n\n\nCode\ndatetime_range_slider = pn.widgets.DatetimeRangeSlider(\n    name=\"Datetime Range Slider\",\n    start=datetime(2017, 1, 1),\n    end=datetime(2019, 1, 1),\n    value=(datetime(2017, 1, 1), datetime(2018, 1, 10)),\n    step=10000,\n)\n\ndatetime_range_slider",
    "crumbs": [
      "Home",
      "Notebooks",
      "Overview of the event"
    ]
  },
  {
    "objectID": "notebooks/06_psp_examples.html",
    "href": "notebooks/06_psp_examples.html",
    "title": "Parker Solar Probe Examples",
    "section": "",
    "text": "Code\n%load_ext autoreload\n%autoreload 2\nCode\nfrom psp.config.psp import PSPConfig\nfrom psp.plot import plot_event, plot_candidate_tplot\nimport pytplot\nfrom discontinuitypy.utils.dataset import unique_events, keep_good_fit\nfrom datetime import timedelta\nimport polars as pl\nCode\np_conf = PSPConfig(enc=7)\n\n\n0 : psp_fld_l2_mag_RTN_4_Sa_per_Cyc\n1 : psp_swp_spi_sf00_L3_DENS\n2 : psp_swp_spi_sf00_L3_VEL_RTN_SUN\n3 : psp_swp_spi_sf00_L3_VEL_RTN\n4 : psp_swp_spi_af00_L3_DENS\n5 : psp_swp_spi_af00_L3_VEL_RTN_SUN\n6 : psp_swp_spi_af00_L3_VEL_RTN\n7 : Tp_spani_b\n8 : Tp_spanib_b\nCode\ndata, file = p_conf.produce_or_load()",
    "crumbs": [
      "Home",
      "Notebooks",
      "Parker Solar Probe Examples"
    ]
  },
  {
    "objectID": "notebooks/06_psp_examples.html#discontinuities-with-bconst",
    "href": "notebooks/06_psp_examples.html#discontinuities-with-bconst",
    "title": "Parker Solar Probe Examples",
    "section": "Discontinuities with B=const",
    "text": "Discontinuities with B=const\n\n\nCode\nimport hvplot.xarray  # noqa\n\nhvplot.extension(\"matplotlib\")\n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n\n\n\n24-Aug-24 12:49:58: DeprecationWarning: backend2gui is deprecated since IPython 8.24, backends are managed in matplotlib and can be externally registered.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nn = 2\nevents = (\n    data.pipe(keep_good_fit).pipe(unique_events).filter(pl.col(\"db_over_b_max\") &lt; 0.05)\n)\n\nfor event in events.head(n=n).rows(named=True):\n    display(plot_candidate_tplot(event, offset=timedelta(seconds=5)))\n\n\n2024-08-24 12:52:24.698 | INFO     | space_analysis.ds.tplot.formulary:ts_Alfven_speed:22 - Time of B and density are not the same, interpolating density to B\n\n\n\n\n\n2024-08-24 12:52:25.270 | INFO     | space_analysis.ds.tplot.formulary:ts_Alfven_speed:22 - Time of B and density are not the same, interpolating density to B\n\n\n\n\n\nWe can see it is necessary to interpolate the magnetic field data to plasma data’s time resolution to properly calculate the Alfvenicity.",
    "crumbs": [
      "Home",
      "Notebooks",
      "Parker Solar Probe Examples"
    ]
  },
  {
    "objectID": "notebooks/06_psp_examples.html#discontinuities-with-close-theoretical-anisotropy-predictions",
    "href": "notebooks/06_psp_examples.html#discontinuities-with-close-theoretical-anisotropy-predictions",
    "title": "Parker Solar Probe Examples",
    "section": "Discontinuities with close theoretical anisotropy predictions",
    "text": "Discontinuities with close theoretical anisotropy predictions\n\n\nCode\nimport polars as pl\n\n\ndef find_events(df: pl.DataFrame):\n    return (\n        df.with_columns(\n            Λ_t=1 - (pl.col(\"v.ion.change.l\") / pl.col(\"v.Alfven.change.l\")) ** 2\n        )\n        .with_columns(rate=(pl.col(\"Λ_ion\") / pl.col(\"Λ_t\") - 1).abs())\n        .sort(\"rate\")\n    )\n\n\nevents = find_events(p_conf.events.pipe(keep_good_fit).pipe(unique_events))\n\n\n\n\nCode\nfrom great_tables import GT\n\ndata = events.select(\"tstart\", \"tstop\", \"Λ_t\", \"Λ_ion\", \"rate\")\n\nGT(data.head()).fmt_datetime(columns=[\"tstart\", \"tstop\"]).fmt_number(\n    columns=[\"Λ_t\", \"Λ_ion\", \"rate\"], decimals=2\n)\n\n\n\n\n\n\n\n\ntstart\ntstop\nΛ_t\nΛ_ion\nrate\n\n\n\n\n2021-01-17 13:22:56\n2021-01-17 13:23:12\n0.90\n0.74\n0.18\n\n\n2021-01-17 14:02:48\n2021-01-17 14:03:04\n0.70\n0.92\n0.30\n\n\n2021-01-17 13:54:16\n2021-01-17 13:54:32\n0.79\n0.51\n0.35\n\n\n2021-01-18 19:17:44\n2021-01-18 19:18:00\n0.34\n0.18\n0.47\n\n\n2021-01-18 19:19:44\n2021-01-18 19:20:00\n0.36\n0.18\n0.48\n\n\n\n\n\n\n        \n\n\n\nCode\npytplot.tplot_options(\"ysize\", 10)\n\ntitle = \"Ion anisotropy: {:.2f} Theory anisotropy: {:.2f}\"\n\nfor event in events.head(n=n).rows(named=True):\n    fig, axs = plot_event(event)\n    axs[0].set_title(title.format(event[\"Λ_ion\"], event[\"Λ_t\"]))\n    fig.show()\n    display(plot_candidate_tplot(event))\n\n\n01-Jul-24 14:18:40: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n\n\n\n01-Jul-24 14:18:40: psp_fld_l2_mag_RTN_4_Sa_per_Cyc_temp is currently not in pytplot.\n2024-07-01 14:18:40.976 | INFO     | space_analysis.ds.tplot.formulary:ts_Alfven_speed:22 - Time of B and density are not the same, interpolating density to B\n\n\n01-Jul-24 14:18:42: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n\n\n\n01-Jul-24 14:18:42: psp_fld_l2_mag_RTN_4_Sa_per_Cyc_temp is currently not in pytplot.\n2024-07-01 14:18:42.515 | INFO     | space_analysis.ds.tplot.formulary:ts_Alfven_speed:22 - Time of B and density are not the same, interpolating density to B\n\n\n\n\nNone\n\n\n\n\n\n\n\nNone",
    "crumbs": [
      "Home",
      "Notebooks",
      "Parker Solar Probe Examples"
    ]
  },
  {
    "objectID": "notebooks/events/index.html",
    "href": "notebooks/events/index.html",
    "title": "Events",
    "section": "",
    "text": "Starting point for the PSP encounter analysis.\nPSP Science Planning\nOrbit Plotter - PSP Science Gateway",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events"
    ]
  },
  {
    "objectID": "notebooks/events/index.html#psp-earth",
    "href": "notebooks/events/index.html#psp-earth",
    "title": "Events",
    "section": "2018-10-24 PSP Earth",
    "text": "2018-10-24 PSP Earth\nfile:/Users/zijin/projects/psp_conjunction/files/psp_v.vap?timerange=2018-10-23+through+2018-10-25\nPSP plasma data is very sparse (6 data point/day)",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events"
    ]
  },
  {
    "objectID": "notebooks/events/index.html#trange-encounter-8",
    "href": "notebooks/events/index.html#trange-encounter-8",
    "title": "Events",
    "section": "Trange: Encounter 8",
    "text": "Trange: Encounter 8\n\nWHPI - Campaign: PSP 15th Perhihelion\n\n2021-05-09\n\n\nvap+cdaweb:ds=PSP_SWP_SPC_L3I&filter=psp&id=vp_moment_RTN[:,0];vp_moment_RTN[:,1];vp_moment_RTN[:,2]&timerange=2021-05-07+through+2021-05-08\n|rebundle(vp_moment_R,vp_moment_T,vp_moment_N)|magnitude()\n|rebundle(psp_fld_l2_mag_RTN_1min__0,psp_fld_l2_mag_RTN_1min__0,psp_fld_l2_mag_RTN_1min__0)|magnitude()\n\nops: “|rebundle(vp_moment_R,vp_moment_T,vp_moment_N)|magnitude()” title: “PSP/SWP_SPC Proton bulk velocity from the 1st moment of the reduced distribution function in [inertial] RTN coordinate system (All Qualities)” y: label: V (km/s)\nops: “|rebundle(B_R,B_T,B_N)|magnitude()” y: label: B (nT) title: PSP_FLD/MAG_RTN_1min Magnetic field in RTN coordinates (1 minute cadence)\n\nPSP/PSP/SWEAP/SPAN Partial Moment Velocity in RTN Coordinates and Sun reference frame |rebundle(Vx RTN,Vy RTN,Vz RTN)|magnitude()\nWind or ACE\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntr = ‘2021-05-06 22:46 to 2021-05-15 22:46’ vp = getDataSet( ‘vap+cdaweb:ds=PSP_SWP_SPC_L3I&filter=psp_SW&id=vp_moment_RTN’, tr ) plot( 0, vp )\ndensity5min= getDataSet( ‘http://cdaweb.gsfc.nasa.gov/pub/data/ace/mag/level_2_cdaweb/mfi_k0/2017/ac_k0_mfi_20170117_v01.cdf?Magnitude’) dst60min= getDataSet( ‘http://cdaweb.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/2017/omni2_h0_mrg1hr_20170101_v01.cdf?DST’)\nt5min= density5min.property(QDataSet.DEPEND_0)\n( density, flux, dst ) = synchronize( t5min, density5min, flux4min, dst60min, nn=1 ) # experimental function (note there is a built-in function in Autoplot v2017a. plot( 1, flux ) plot( 2, dst )",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events"
    ]
  },
  {
    "objectID": "notebooks/events/index.html#trange",
    "href": "notebooks/events/index.html#trange",
    "title": "Events",
    "section": "Trange",
    "text": "Trange\n\nC4, 18 September, b 2021. This will be an inferior triple SO–PSP–STEREO-A conjunction, with SO inside the orbit of Venus around 0.6 AU, PSP at about 0.7 AU, and STEREO-A at 0.9 AU. This will be an occasion for joint in situ studies of the properties of turbulence and dynamics of a solar wind stream between 0.5 and 1 AU.\n\nhttps://solar-mach.streamlit.app/?embedded=true&date=20210925&time=0000&coord_sys=0&plot_spirals=1&plot_sun_body_line=1&plot_trans=0&plot_markers=Numbers&long_offset=270&bodies=STEREO+A&bodies=Earth&bodies=BepiColombo&bodies=Parker+Solar+Probe&bodies=Solar+Orbiter&speeds=346&speeds=485&speeds=400&speeds=300&speeds=287&",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events"
    ]
  },
  {
    "objectID": "notebooks/events/index.html#trange-encounter-11-2022-02",
    "href": "notebooks/events/index.html#trange-encounter-11-2022-02",
    "title": "Events",
    "section": "Trange: Encounter 11, 2022-02",
    "text": "Trange: Encounter 11, 2022-02\n\nE11, C6, Q8, Q9 23–27 February, 2022. PSP approaches encounter E11 beginning with a trailing quadrature Q8 on 23 February, 2022, appearing on the east limb of the Sun from SO, before rapidly going through conjunction with STEREO-A and then SO and Earth (24 and 25 February, respectively) at perihe- lion with the Earth–Sun–STEREO-A angle ’40◦ and the Earth–",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events"
    ]
  },
  {
    "objectID": "notebooks/events/e2.html",
    "href": "notebooks/events/e2.html",
    "title": "Encounter 2 (2019-04-07)",
    "section": "",
    "text": "ENLIL Solar Wind Prediction - Parker Solar Probe - Perihelion 02\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPSP Observation Overvall\n\n\n\n\n\n\n\n\n\n\n\nPSP observation\n\n\n\n\n\n\n\nACE observation\n\n\n\n\n\n\n\nACE observation (continued)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2019-04-05\n\n\n\n\n\n\n\n2019-04-06\n\n\n\n\n\n\n\n2019-04-07\n\n\n\n\n\n\n\n2019-04-08\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfile:///Users/zijin/projects/autoplot/psp_mag_sw.vap?timerange=2019-04-01+through+2019-04-15\nfile:///Users/zijin/projects/autoplot/psp_mag_sw.vap?timerange=2019-04-06+through+2019-04-08\nfile:///Users/zijin/projects/autoplot/ace.vap?timerange=2019-04-08+through+2019-04-10\nfile:///Users/zijin/projects/autoplot/ace.vap?timerange=2019-04-11+through+2019-04-14\nfile:///Users/zijin/projects/autoplot/wind_plasma.vap?timerange=2019-04-08+through+2019-04-10\nfile:///Users/zijin/projects/autoplot/dscovr.vap?timerange=2019-04-08+through+2019-04-10",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events",
      "Encounter 2 (2019-04-07)"
    ]
  },
  {
    "objectID": "notebooks/events/e2.html#observations",
    "href": "notebooks/events/e2.html#observations",
    "title": "Encounter 2 (2019-04-07)",
    "section": "",
    "text": "PSP Observation Overvall\n\n\n\n\n\n\n\n\n\n\n\nPSP observation\n\n\n\n\n\n\n\nACE observation\n\n\n\n\n\n\n\nACE observation (continued)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2019-04-05\n\n\n\n\n\n\n\n2019-04-06\n\n\n\n\n\n\n\n2019-04-07\n\n\n\n\n\n\n\n2019-04-08",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events",
      "Encounter 2 (2019-04-07)"
    ]
  },
  {
    "objectID": "notebooks/events/e2.html#scripts",
    "href": "notebooks/events/e2.html#scripts",
    "title": "Encounter 2 (2019-04-07)",
    "section": "",
    "text": "file:///Users/zijin/projects/autoplot/psp_mag_sw.vap?timerange=2019-04-01+through+2019-04-15\nfile:///Users/zijin/projects/autoplot/psp_mag_sw.vap?timerange=2019-04-06+through+2019-04-08\nfile:///Users/zijin/projects/autoplot/ace.vap?timerange=2019-04-08+through+2019-04-10\nfile:///Users/zijin/projects/autoplot/ace.vap?timerange=2019-04-11+through+2019-04-14\nfile:///Users/zijin/projects/autoplot/wind_plasma.vap?timerange=2019-04-08+through+2019-04-10\nfile:///Users/zijin/projects/autoplot/dscovr.vap?timerange=2019-04-08+through+2019-04-10",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events",
      "Encounter 2 (2019-04-07)"
    ]
  },
  {
    "objectID": "notebooks/events/e4.html",
    "href": "notebooks/events/e4.html",
    "title": "Encounter 4 (2020-01-28)",
    "section": "",
    "text": "WHPI - Campaign: 2226\n\nWHPI - Parker Perihelion 4 Campaign Highlights\n\nENLIL Solar Wind Prediction - Parker Solar Probe - Perihelion 04\n\n\nThe orbit of Parker Solar Probe (Parker) during the 4th encounter with the Sun presented a unique opportunity for a multi-mission and multi-observatory collaboration as the 4th perihelion occurred nearly at the Sun-Earth line. This unprecedented configuration allowed ground-based solar observatories to measure the solar surface that Parker was magnetically connected to while Parker simultaneously measured the near-Sun environment at the closest distance to the Sun recorded to date (27.8 RS). Additionally, near-Earth missions (e.g., ACE, ARTEMIS, and MMS) could then measure this solar wind once it reached 1 au to study the evolution of solar wind structures as they propagate radially outward from the Sun. Probes within the magnetosphere of Earth, and observatories focused on the ionosphere, could then study how these structures affect the near-Earth environment. To take advantage of this great opportunity for large-scale coordinated science, the Parker Project Science team and the Whole Heliosphere and Planetary Interactions (WHPI) group organized a campaign that has brought together observatories and missions from across the world. This page is meant to contain information and links relevant to the Parker Solar Probe Encounter 4 campaign. For more information, please contact Robert C. Allen (Robert.Allen@jhuapl.edu), the Parker Project Science team coordinator for this effort.\n\nConjunction with In Situ Observations\n\nIn addition to magnetic footpoint mapping for solar observers, ballistic mappings were performed to estimate when solar wind observed at Parker may reach 1 au at either STEREO-A or near-Earth observers. This shows that the footpoints of STEREO-A and Parker may have been near each other from Jan 26th, 2020 to Jan 28th, 2020 (where the red lines cross the black horizontal line at 0), while the footpoints of Earth and Parker may have been close from Jan 29th, 2020 until Jan 31st, 2020 (where the blue lines cross the zero-line).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nStart Date: 20200125\nEnd Date: 20200131\nfile:///Users/zijin/projects/autoplot/psp_mag_sw.vap?timerange=2020-01-20+through+2020-01-31\nfile:///Users/zijin/projects/autoplot/psp_mag_sw.vap?timerange=2020-01-27+through+2020-01-31\nfile:///Users/zijin/projects/autoplot/ace.vap?timerange=2019-04-08+through+2019-04-10\nfile:///Users/zijin/projects/autoplot/ace.vap?timerange=2019-04-11+through+2019-04-14\nfile:///Users/zijin/projects/autoplot/wind_plasma.vap?timerange=2019-04-08+through+2019-04-10\nfile:///Users/zijin/projects/autoplot/dscovr.vap?timerange=2019-04-08+through+2019-04-10",
    "crumbs": [
      "Home",
      "Notebooks",
      "Events",
      "Encounter 4 (2020-01-28)"
    ]
  },
  {
    "objectID": "notebooks/00_calc.html",
    "href": "notebooks/00_calc.html",
    "title": "Time of arrival",
    "section": "",
    "text": "Code\nfrom plasmapy.formulary import beta\nimport astropy.units as u\n\n\n\n\nCode\nc1 = beta(1 * u.K, 1 * u.cm**-3, 1 * u.nT)\nc2 = beta(1 * u.eV, 1 * u.cm**-3, 1 * u.nT)\n\nprint(\"Coeficiente for beta at T=1K, n=1cm^-3, B=1nT: \", c1)\nprint(\"Coeficiente for beta at T=1eV, n=1cm^-3, B=1nT: \", c2)\n\n\nCoeficiente for beta at T=1K, n=1cm^-3, B=1nT:  3.469949406357831e-05\nCoeficiente for beta at T=1eV, n=1cm^-3, B=1nT:  0.402670907669414\n\n\n\n\nCode\nr = 1 * u.AU\nv_fast = 800 * u.km / u.s\nv_slow = 300 * u.km / u.s\n\nt_min = r / v_fast\nt_max = r / v_slow\n\n\nprint(f\"Fast wind ({v_fast}) to travel 1 AU : {t_min.to(u.day)}\")\nprint(f\"Slow wind ({v_slow}) to travel 1 AU : {t_max.to(u.day)}\")\n\n\nFast wind (800.0 km / s) to travel 1 AU : 2.1643210460069446 d\nSlow wind (300.0 km / s) to travel 1 AU : 5.771522789351852 d",
    "crumbs": [
      "Home",
      "Notebooks",
      "Time of arrival"
    ]
  }
]